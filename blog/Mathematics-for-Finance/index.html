<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Mathematics for Finance | Sudhansh Peddabomma</title> <meta name="author" content="Sudhansh Peddabomma"> <meta name="description" content=""> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%91%BE&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://sudhansh6.github.io/blog/Mathematics-for-Finance/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?6185d15ea1982787ad7f435576553d64"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">Sudhansh Peddabomma</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">Articles</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects</a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/challenges/">Challenges</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/misc/">Miscellaneous</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">Mathematics for Finance</h1> <p class="post-meta">April 1, 2024</p> <p class="post-tags"> <a href="/blog/2024"> <i class="fa-solid fa-calendar fa-sm"></i> 2024 </a>   ·   <a href="/blog/category/notes"> <i class="fa-solid fa-tag fa-sm"></i> Notes</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <h1 id="introduction">Introduction</h1> <p>We will discuss mathematics for options, pricing methods, and optimizing the performance of a portfolio. We will cover discrete (finite probability spaces, tree models) as well as continuous math (Brownian Motion, Black-Scholes formula, Martingale theory).</p> <p>The theory in the course revolves around the “No Arbitrage theorem” which is closely related to one-price principle. Similarly, the idea of one-price principle theorizes that a set of investments with the same net outcome, albeit with different transactions, should have the same price.</p> <h2 id="financial-markets">Financial Markets</h2> <p>A <em>financial market</em> consists of tradable products such as stocks, bonds, currencies and indices. The market consists of two parties - the buyers and the sellers, who buy and sell these products respectively trying to make an <em>arbitrage</em> from the transactions. Formally, an <em>arbitrage opportunity</em> is a chance for a risk-free profit.</p> <h3 id="odds-and-arbitrage">Odds and Arbitrage</h3> <p>Let us consider the example of a horse race, where \(P(\text {S wins}) = 3/4\) and \(P(\text{W wins}) = 1/4\). How do we calculate the odds against \(W\) winning? It is given by \(P(\text{W wins})/P(\text{W loses}) = 3\). This situation is called \(3\text{-to-}1\) odds. That means, a dollar bet \(\$ 1\) brings \(\$ 3\) if \(W\) wins. Similarly, for \(S\), it brings \(\$ 0.3\). These bets are an example of a fair game, the net reward \(\frac{1}{4} (3) + \frac{3}{4}(-1)\) is \(0\).</p> <p>A <em>bookmaker</em> sets the odds for such scenarios. Consider an other example where the odds are \(9\text{-to-}5\) against \(W\) and \(2\text{-to-}5\) against \(S\). We claim that this results in an arbitrage for the bookmaker. To illustrate this, consider the bets \(\$ 10\) on \(S\) and \(\$ 5\) on \(W\). The payoff for the bookmaker when \(S\) wins is \(5 - 10\frac{2}{5} = 1\). When \(W\) wins, the profit is \(10 - 5\frac{9}{5} = 1\). A bookmaker typically decides the odds after the bets are made so that arbitrage is made in any scenarios.</p> <p>Ideally, one wants to make profit from such games. How do we do this? In the first example, we considered the probabilities and calculated the odds. To decide the odds for arbitrage, we do the reverse. In the above scenario, given the odds, the probabilities are \(P(S) \approx 71\%\) and \(P(W) \approx 36\%\). The probabilities add up to slightly above \(100\%\), which makes up the arbitrage for the bookmaker.</p> <h2 id="contingent-claim">Contingent Claim</h2> <p>A <strong>derivative</strong> or a <strong>contingent claim</strong> is a security whose value depends on the value of an underlying asset. Forward contracts, futures contracts and options are examples of such securities. Interestingly, the markets around the world also use derivatives whose underlying asset is also a derivative. Such securities are called as <em>structured products</em>.</p> <p>With such contrived products, it is important to choose a <em>fair price</em> to ensure there are no arbitrage opportunities in the market. To do so, we introduce the required mathematical notation - \(X\) is a real-valued random variable defined on a probability space \((\Omega, \mathcal F, P)\) and \(\mathcal G\) is a sub-\(\sigma\)-algebra of \(\mathcal F\). For unfamiliar readers, in probability theory, a probability space consists of three elements -</p> <ul> <li>A sample space \(\Omega\), which is the set of all possible outcomes. For example, the sample space for a dice roll is \(\Omega = \{1, 2, 3, 4, 5, 6\}\).</li> <li>An event space or a set of events is represented by \(\mathcal F\). For example, the events constituting an odd dice roll is \(\mathcal F = \{1, 3, 5\}\).</li> <li>A probability function \(P\), assigns a probability (a number between \(0\) and \(1\)) to each event in the event space.</li> </ul> <p>The term \(\sigma\)-algebra on a set \(X\) refers to a nonempty collection \(\Sigma\) of subsets of \(X\) closed under complement, countable unions, and countable intersections. The pair \((X, \Sigma)\) is called a <strong>measurable space</strong>.</p> <p>In general, we model the price of a contract with a random variable \(X\) that evolves across time with \(X(w) \geq 0\) (all the values for the random variable are positive). For example, for the <em>call option</em> described in #options, we have</p> \[X(w) = (S(w)_t - K)^+\] <p>Similarly, for a <em>put</em> option, where the holder has the right to sell a certain asset at a fixed price, we get</p> \[X(w) = (K - S_T)^+\] <p>There can be other kinds of <em>structured products</em> like</p> <ul> <li> \[X = \max(S_1, \dots, S_T)\] </li> <li> \[X = \left(\frac{1}{T} \sum_{t = 1}^T S_t - K\right)^+\] </li> </ul> <p>In the above definitions, the variables \(w, S_t\) capture the evolution of price across time, and are described in the later section. The key takeaway is that, we are trying to price a contingent claim \(X\) - find \(C_0(X)\)</p> <h3 id="forwards-contract">Forwards Contract</h3> <p>A <strong>forward constract</strong> is an agreement to buy or sell an asset at a <em>certain</em> future time for a <em>certain</em> price. Consider the following example,</p> <ul> <li>\(A\) agrees at time \(t = 0\) to sell one share at time \(T\) for \(\$ F\). We assume that \(A\) buys the share at \(t = 0\) at price \(S_0\).</li> <li>\(B\) agrees at time \(t = 0\) to buy one share at time \(T\) for \(\$ F\)</li> </ul> <p>We assume that \(A, B\) don’t invest their own money, and borrow money from the bank to perform transactions. Given such a scenario, how do we decide a <em>fair price</em> \(F\)? To simplify the calculations, we assume the following -</p> <ul> <li>No transaction costs or dividends.</li> <li>Market is liquid - every transaction has a buyer and seller available.</li> <li>Investor is <em>small</em> compared to the market. That is, the action of the investor is not momentous enough to change the price of the stock in the market.</li> <li>Short selling/borrowing of stock is allowed.</li> </ul> <p>\(B\) can invest the amount in the bank for a <em>continuous compound</em> interest rate \(r\) during this term. The claim is that \(F = S_0 e^{rT}\) where \(S_0\) is the price of the share at \(t = 0\). To analyze this, we consider the following cases -</p> <ul> <li> \[F &gt; S_0 e^{rT}\] <p>\(A\) sells the share for \(\$ F\) and repays the loan of \(\$ S_0\) with interest - \(\$ S_0 e^{rT}\). The profit \(A\) gets is \(F - S_0 e^{rT}\)</p> </li> <li> \[F &gt; S_0e^{rT}\] <p>\(B\) short sells one share for \(\$ S_0\) and invests \(\$ S_0\) in the bank. The money in the bank will grow to \(S_0 e^{rT}\) at \(t = T\), and \(B\) buys one share at \(F\). The profit for \(B\) here is \(S_0 e^{rT} - F &gt; 0\)</p> </li> </ul> <p>So the fair price is \(S_0 e^{rT}\) where neither \(A\) nor \(B\) can take advantage.</p> <p><em>Note.</em> A <strong>futures contract</strong> is similar to a forward contract but is traded on a financial exchange. They typically have a delivery month rather than a delivery date, and are followed by a settlement procedure called <em>marking to market</em>.</p> <h3 id="options">Options</h3> <p>An <strong>option</strong> is a contract which gives the holder of the option the right, but not the obligation, to buy other sell a given security at a given price (called the <em>strike</em> price) within a fixed time period \([0, T]\). A <strong>call option</strong> gives the option holder the right to buy at the given price, whereas the <em>put option</em> gives the option holder the right to sell at the given price.</p> <h1 id="european-call-options">European Call Options</h1> <p>A <em>European option</em> can only be exercised by the holder of the option at the expiration time \(T\) (unlike an American Option, which will be discussed in the later sections). We have the following equation for profit of a <em>call option</em> holder, assuming the option is free -</p> \[P = (S_T - K)^+ = \begin{cases} S_T - K &amp; S_T &gt; K \\ 0 &amp; S_T \leq K \end{cases}\] <p>How do we decide the <em>fair price</em> at \(t = 0\) for the option? We need to use probability results to model the price movement to decide this. In discrete time settings, we use different models like Cox, Ross and Rubenstein. In continuous time frame, we use Brownian motion using the Black-Scholes model. In both cases, there exists a unique fair price. However, if the product is slightly more complicated, then there is no unique fair price.</p> <h2 id="binomial-model">Binomial Model</h2> <p>Also known as <strong>Cox-Ross-Rubenstein Model (CRR)</strong> is a discrete time model for a financial market defined for \(t = 0, 1, \dots, T\). At each time instant the model considers the following two types of assets</p> <h4 id="bonds">Bonds</h4> <p>Considered as a risk-free asset, a <em>bond</em> yields at a constant rate of return \(r \geq 0\) over each time period. The price is modeled as \(B_t = B_0 (1 + r)^t\) for \(t = 0, 1, \dots, T\). \(B_0\) is typically assumed as \(1\).</p> <h4 id="stocks">Stocks</h4> <p>Stocks are considered as risk-models where the price evolution is captured using binomial random variables. We consider the model \(S_t = s_o \zeta_1 \dots \zeta_{t_1} = S_{t - 1} \zeta_t\) where \(S_0 &gt; 0\) is the constant initial price. That is, the stock price process is modeled as an <em>exponential random walk</em>. In this model, we assume \(P(\zeta_t = u) = p\) and \(P(\zeta_t = d) = 1- p\) where \(0 &lt; d &lt; 1 + r &lt; u\) where \(d, u\) are the down and up movements respectively. That is, \(S_{t + 1} = S_t u\) represents the price of the stock if the price has moved upward at time \(t\).</p> <p>Concretely, the probability space \((\Omega, \mathcal F, P)\) is such that \(\Omega\) is the finite set of \(2^T\) possible outcomes for the values of stock price \((T + 1)\)-tuple (for \(S_0, S_1, \dots, S_T)\), \(\mathcal F\) is the \(\sigma\)-algebra consisting of all possible subsets of \(\Omega\), and \(P\) is the probability measure on \((\Omega, \mathcal F)\) associated with the Bernoulli probability \(p\).</p> <p>Let the field \(\mathcal F_0 = \{ \phi, \Omega\}\) and</p> \[\begin{align*} \mathcal F_1 &amp;= \sigma(S_1) \\ &amp;= \{ \phi, \Omega, \{w: S_1(w) = S_0u \}, \{w: S_1(w) = S_0 d\}\} \\ &amp;= \sigma(\{S_1 = S_0u\}), \{S_1 = S_0d\}) \end{align*}\] <p>This is a partition of \(\Omega\). Similarly, for \(t = 2\), we get</p> <p>\(\mathcal F_1 = \{ \phi, \Omega, \{uu, ud\}, \{dd, du\}\}\). Extrapolating this,</p> \[\mathcal F_t = \sigma(S_1, \dots, S_t) = \sigma(\zeta_2, \dots, \zeta_t)\] <p>We get \(\#(\mathcal F)_t = 2^t\). This evolution can be represented using a binomial tree of the following form -</p> \[\begin{align*} &amp;\boxed{} \\ \boxed{d} &amp;\quad \boxed{u} \\ \boxed{dd} \quad \boxed {du} &amp;\quad \boxed{ud} \quad \boxed{uu} \\ &amp;\dots \end{align*}\] <h2 id="trading-strategies-and-fair-pricing">Trading Strategies and Fair Pricing</h2> <p>A strategy \(\phi\) in stocks and bonds consists of sequence of random variable pairs \(\phi = \{(\alpha_t, \beta_t); t = 1, \dots, T\}\) where \(\alpha_t\) represents the holdings of a stock and \(\beta_t\) represents the holdings of a bond on day \(t\) (The unit for time can be taken as minutes, hours, etc., but we consider days). We also have the following assumptions</p> <ol> <li>Predictability: \(\alpha_t, \beta_t \in \mathcal F_{t - 1}, t = 1, \dots, T\)</li> <li>Self-financing: \(\alpha_t S_t + \beta_t B_t = \alpha_{t + 1} S_t + \beta_{t + 1}B_t\). That is, there is no influx or outflux of money asides from the changes in the underlying assets. We have some initial investment and assume that \(\alpha_1, \beta_1\) are \(\mathcal F_0\)-measurable are constant.</li> </ol> <p>The value of the portfolio at time \(t\) is given by \(V_t(\phi) = \alpha_t S_t + \beta_t B_t, t = 1, \dots, T\) and \(V_0(\phi) = \alpha_1 S_0 + \beta B_0 = \alpha_1 S_1 + \beta_1\) We can now define the concept of <strong>arbitrage</strong> formally.</p> <h3 id="arbitrage">Arbitrage</h3> <p>An arbitrage is a trading strategy \(\phi\) such that \(V_0(\phi) = 0\) and \(V_t(\phi) \geq 0\). That is, we don’t have any initial investment and get a profit at time \(t = T\). However, note that \(V_t(\phi)\) is a random variable, so the inequality is assumed to be a point-wise inequality wherein \(V_T(\phi)(w) \geq 0, \forall w \in \Omega\). This is a stronger assumption than \(P(V_T(\phi) &gt; 0) &gt; 0 \equiv E(V_T(\phi)) &gt; 0 \equiv V_T(\phi)(w) &gt; 0\) for some \(w \in \Omega\). Notice that the last equivalence does not have any probability term in the expression. This equivalence is important to note since it makes the definition invariant of the underlying probability assumptions.</p> <h3 id="hedge">Hedge</h3> <p>A hedging or a replicating strategy \(\phi\) has the property \(V_T(\phi) = X\). That is, to price a contingent claim \(X\), if we find a trading strategy \(\phi\) with cost (initial investment) \(V_0(\phi)\), such that \(V_T(\phi) = X\), then \(V_0(\phi)\) is a fair price of \(X\) by the one-price principle. Essentially, with the price “\(V_0(\phi)\)” we bought an opportunity that resulted in a value of “\(V_T(\phi)\)” at time \(T\). If a contingent claim \(X\) has the same value at time \(T\), then its fair price should be \(V_0(\phi)\) at \(t = 0\).</p> <p>Using this as a motivation, let us price a European call option. Our approach is as follows - an investment in the underlying stock and a bond should result in the same outcome as an investment in the option itself. The movements in the option will be correlated with those of the underlying stock, allowing us to correctly determine a fair price at every time instant.</p> <h4 id="hedging-for-t--1">Hedging for \(T = 1\)</h4> <p>Consider the following example, where we try to hedge \(X\) at \(t = 1\). That is, we are trying to find a strategy \(\phi = (\alpha_1, \beta_1)\) such that \(V_1(\phi) = \alpha_1 S_1 + \beta_1 B_1\equiv X\).</p> <p>We have two cases based on the stock movement -</p> <ul> <li> \[\alpha_1 S_0 u + \beta_1 (1 + r) = X^u\] </li> <li> \[\alpha_1 S_0 d + \beta_1 (1 + r) = X^d\] </li> </ul> <p>Equivalently, \(\alpha_1 S_0(u - d) = X^u - X^d\)</p> \[\begin{align*} \alpha_1 &amp;= \frac{X^u - X^d}{u - d}\frac{1}{S_0} \\ \beta_1 &amp;= \frac{uX^d - d X^u}{u - d}\frac{1}{B_1} \end{align*}\] <p>What do the above expressions mean? Investing \(\alpha_1\) in stock and \(\beta_1\) in bond at the end of day \(0\) will result in same price as \(X\) on day \(1\). Manipulating the expressions further,</p> \[\begin{align*} V_0 (\phi) &amp;= \alpha_1 S_0 + \beta_1 \\ &amp;= \frac{X^u - X^d}{u- d} + \frac{uX^d - d X^u}{u - d}\frac{1}{1 + r} \\ &amp;= \frac{1}{1 + r}\left\{X^u \left(\frac{1 + r - d}{u - d}\right) + X^d \left(\frac{u - 1 - r}{u - d}\right)\right\} \\ &amp;= \frac{1}{1 + r} \mathbb E^* (X) \end{align*}\] <p>The above expression is reminiscent of an expectation formulation where \(p^* = \frac{1 + r - d}{u - d}\) and \(0 &lt; p^* &lt; 1\). Here, the set of discounted stock prices \(\{S_0, S_1/(1 + r)\}\) form a \(p^*\)-martingale.</p> <p>What is a Martingale? A <strong>Martingale</strong> is a sequence of random variables representing a stochastic process for which, at a particular time, the conditional expectation of the next value in the sequence is equal to the present value, regardless of all prior values.</p> <p>In the above case, we have</p> \[\begin{align*} \mathbb E^* (S_1/(1 + r) \vert \mathcal F_0) &amp;= S_0 u \cdot p^* + S_0 d \cdot (1 - p)^* \\ &amp;= S_0 \implies \mathbb E^*(S_1) = S_0(1 + r) \end{align*}\] <p>It is important to realize that computing expectations under \(p^*\) is a mathematical device. We are not assuming that the stock price actually moves according to this probability. That is, \(p^*\) may be unrelated to the subjective probability \(p\) that we associate with the binomial model for movements in the stock price.</p> <p><strong>Theorem 1 (T = 1)</strong> <em>For a given \(X\), the value \(\mathbb E^*(X)/(1 + r)\) is the non-arbitrage price of \(X\) at \(t = 0\).</em> <em>Proof.</em> Let \(C_0\) is the market price of the contingent claim \(X\) and \(V_0 = \mathbb E^*(X)/(1 + r) = V_0(\bar \phi)\) where \(\bar \phi = (\bar \alpha_1, \bar \beta_1)\) (the values we calculated before). Consider the following cases -</p> <ol> <li> <p>Say \(C_0 &gt; V_0\) To make an arbitrage in this situation, we sell \(X\) for \(C_0\). We invest the amount \(V_0\) in the stock and amount \(C_0 - V_0 &gt; 0\) in bonds at \(t = 0\). At time \(t = 1\), we get \(V_1(\bar \phi) = X\) yielding \((C_0 - V_0)(1 + r) &gt; 0\) as profit from the bond.</p> </li> <li> <p>Say \(C_0 &lt; V_0\) We do the opposite from above, where we buy the asset \(X\). Short sell \(\bar \phi\) for \(V_0\), and invest \(C_0\) in \(X\) and \(V_0 - C_0\) in the bond. We get the profit \((V_0 - C_0)(1 + r)\) at \(t = 1\).</p> </li> <li> <p>Say \(C_0 = V_0\) Here, we can show that no one can make an arbitrage. Consider the strategy in stock, bond and contingent claim \(\psi = (\alpha_1, \beta_1, \gamma_1)\). We need to argue that no arbitrage can be made with any such strategy. We have,</p> </li> </ol> \[\begin{align*} V_0(\psi) &amp;= \alpha_1 S_0 + \beta_1 + \gamma_1 C_0 \\ V_1(\psi) &amp;= \alpha_1 S_1 + \beta B_1 + \gamma_1 X \\ \implies \mathbb E^*(V_1(\psi)) &amp;= \mathbb E^*(\alpha_1 S_1 + \beta_1 B1 + \gamma_1 X) \\ &amp;= \alpha_1 \mathbb E^*(S_1) + \beta_1 (1 + r) + \gamma_1 \mathbb E^*(X) \end{align*}\] <p>We can distribute the expectation this way due to the linearity property. Recall that, we typically assume \(B_0 = 1\) for brevity. Continuting the calculations,</p> \[\begin{align*} \mathbb E^*(V_1(\psi)) &amp;= \alpha_1 S_1(1 + r) + \beta_1(1 + r) + \gamma_1 V_0 (\bar \phi)(1 + r) \\ &amp;= \alpha_1 S_1(1 + r) + \beta_1(1 + r) + \gamma_1 C_0 (1 + r) \\ &amp;= (1 + r) V_0 (\psi) \end{align*}\] <p>If \(V_0(\psi) = 0\), then \(\mathbb E^*(V_1(\psi)) = 0\), and if \(V_1(\psi) \geq 0\), then \(P^*(V_1(\psi) = 0) = 1\). That is, \(V_1(\psi) = 0\) meaning no arbitrage can be made with any strategy \(\psi\).</p> <h4 id="general-t">General \(T\)</h4> <p>This analysis can be extended to derive the hedging strategy a general \(t &gt; 1\). Given an \(X\), find \(\phi = \{(\alpha_t, \beta_t): t = 1, \dots, T\}\) such that \(V_T(\phi) = X\) (resulting in \(C_0 = V_0(\phi)\)). To derive such a strategy, we work backwards in time starting from \(V_T(\phi) = X\). This way, we can also calculate the intermediate price - the price to enter the market at some intermediary time \(t\). It is helpful to think of the tree visualization for the price evolution.</p> \[\begin{align*} V_T(\phi) = \alpha_T S_T + \beta_T B_T = X \end{align*}\] <p>conditional on \(\mathcal F_{T - 1}\). Focusing on \(T - 1\) and \(T\), the analysis is similar to the previous case wherein \(X^U = X(w_1 \dots w_{T - 1} u)\) and \(X^d = X(w_1 \dots w_{T - 1} d)\). Doing so we get</p> \[\left. \begin{align*} \alpha_T = \frac{X^u - X^d}{u - d}\frac{1}{S_{T - 1}} \\ \beta_T = \frac{uX^d - dX^u}{u - d}\frac{1}{(1 + r)^T} \end{align*} \right\} \in \mathcal F_{T - 1}\] <p>Using the property of Martingales,</p> \[\begin{align*} \mathbb E^* (X \vert \mathcal F_{T - 1}) = \mathbb E^* [V_T(\phi) \vert \mathcal F_{T - 1}] &amp;= \mathbb E^*[\alpha_T S_T + \beta_T B_T \vert \mathcal F_{T - 1}] \\ &amp;= \alpha_T \mathbb E^*(S_T \vert \mathcal F_{T - 1}) + \beta_T B_T \\ &amp;= \alpha_T \left(p^* S_{T - 1} u + (1 - p^*) S_{T - 1} d\right) + \beta_T B_T \\ &amp;= \alpha_T S_{T - 1}(1 + r) + \beta_T B_T \end{align*}\] <p><em>Note.</em> \(\alpha_T, \beta_T\) are constants with respect to the <em>condition</em> \(\mathcal F_{T - 1}\), and that is why the linearity property can be used.</p> <p>Continuing the previous calculations</p> \[\begin{align*} \mathbb E^*(V_T \vert \mathcal F_{T - 1}) &amp;= \mathbb E^*(\alpha_T S_T + \beta_T B_T \vert \mathcal F_{T - 1}) \\ &amp;= \alpha_T S_{T - 1}(1 + r) + \beta_T B_{T - q}(1 + r) \\ &amp;= (1 + r) \left[\alpha_T S_{T - 1} + \beta_T B_{T - 1}\right] \\ &amp;= (1 + r) \left[\alpha_{T - 1} S_{T - 1} + \beta_{T - 1} B_{T - 1}\right] &amp;\because \text{ self-financing} \\ &amp;= (1 + r) V_{T - 1}(\phi) \end{align*}\] <p>As a result, we have a recursive property</p> \[\begin{align*} V_{t - 1}(\phi) &amp;= \frac{1}{1 + r} \mathbb E^*(V_t(\phi) \vert \mathcal F_{t - 1}) \\ \alpha_t &amp;= \frac{V_t^u - V_t^d}{u - d} \frac{1}{S_{t - 1}} \\ \beta_t &amp;= \frac{uV^d_t - dV^u_t}{u - d} \frac{1}{B_{t - 1}} \end{align*}\] <p>for \(t = T, \dots, 1\)</p> <p>The above relation can also be alternately derived using the <strong>Tower law</strong> to relate the value with \(V_t(\phi)\) for a general \(t\).</p> <blockquote> <p>Tower Law: If \(X\) is a random variable whose expected value \(E ⁡( X )\) is defined, and \(Y\) is any random variable on the same probability space, then \(E(X) = E (E (X \vert Y ) )\), i.e., the expected value of the conditional expected value of \(X\) given \(Y\) is the same as the expected value of \(X\).</p> </blockquote> <p>Then, we get \(\begin{align*} V_t(\phi) &amp;= \frac{1}{1 + r} \mathbb E^*(V_{t + 1} (\phi) \vert \mathcal F_t) \\ &amp;= \frac{1}{1 + r} \mathbb E^*\left(\frac{1}{1 + r} \mathbb E^*(V_{t + 2}(\phi) \vert \mathcal F_{t + 1} ) \vert \mathcal F_t\right) \\ &amp;= \frac{1}{(1 + r)^2} \mathbb E^*\left(\mathbb E^*\left(V_{t + 1} \vert \mathcal F_{t + 1}\right \vert \mathcal F_{t} \right) \\ &amp;= \frac{1}{(1 + r)^2} \mathbb E^*(V_{t + 2} \vert \mathcal F_t) \end{align*}\)</p> <p>Consequently,</p> \[\begin{align*} V_T(\phi) &amp;= \frac{1}{(1 + r)^{T - t}} \mathbb E^*(V_T (\phi) \vert \mathcal F_t) \\ &amp;= \frac{1}{(1 + r)^{T - t}} \mathbb E^*(X \vert \mathcal F_t) \\ V_0 (\phi) &amp;= \frac{1}{(1 + r)^T} \mathbb E^*(X) \end{align*}\] <h3 id="conditional-expectation-of-martingales">Conditional Expectation of Martingales</h3> <p>Given \((\Omega, \mathcal D, P)\) with \(g \subset \mathcal F\), \(X \in L'(\mathcal F)\) (the space of random variables that are integrable with respect to the \(\sigma\)-algebra \(\mathcal F\)) then \(Y = \mathbb E(X \vert g)\) is the random variable such that</p> <ol> <li> \[Y \in L'(g)\] </li> <li>\(\mathbb E(YZ) = \mathbb E(XZ)\) for all \(Z\) that are \(g\)-measurable.</li> </ol> <p>where \(L'\) represents integrability. The above property is the general statement for the law of general statician.</p> <p><em>Special case.</em> When \(\Omega\) is finite (\(\#(\Omega) &lt; \infty\)), then \(\mathcal F = \{ \text{all subsets of } \Omega\}\) and \(\mathcal G = \sigma(G_1, \dots, G_n)\) form a partition (\(G_i \cap G_j = \phi, \cup_{j = i}^n G_j = \Omega\)) of \(\Omega\) with \(P(G_k) &gt; 0\).</p> <p>A random variable \(Z\) is \(g\)-measurable iff \(Z(w) = \sum_{k = 1}^n \mathbb 1_{G_k} (w) \cdot c_k \equiv Z(w) = c_k \text{ if } w \in G_k\) where \(c_k\) is the cardinality of \(G_k\).</p> <p>Then,</p> \[\mathbb E[X \vert \mathcal G](w) = \sum_{k = 1}^n \left(\mathbb 1_{G_k}(w) \cdot E[X \vert G_k]\right)\] <p>From Bayes’ rule</p> \[\mathbb E(X \vert G_k) = \mathbb E(X . \mathbb 1_{G_k}) /P(G_k) = \mathbb E(X; G_k)/P(G_k)\] <p>Using the above results, we get</p> <ol> <li> <p>\(X \to \mathbb E(X \vert Y)\) is linear &amp; positive (\(X \geq 0 \implies \mathbb E(X \vert g) \geq 0\))</p> </li> <li> \[\mathbb E(\mathbb E (X \vert g)) = \mathbb E(X)\] </li> <li> \[\mathbb E(XZ \vert g) \equiv E(X \vert y) Z\] </li> <li>If \(\mathbb E \in g\), then \(E(X \vert g) = X\) and \(X \perp\!\!\!\perp g\), then \(\mathbb E(X \vert Y) = \mathbb E(X)\).</li> </ol> <p><strong>Exercise.</strong></p> <p>Show that \(E( \cdot \vert \mathcal G)\) is a \(\perp\) projection where \(d(X, \tilde X) = \sqrt{\mathbb E(X - \tilde X)^2}\)</p> <h3 id="tower-property">Tower Property</h3> <p>For any \(\mathcal G \subset \mathcal H ( \subset \mathcal F)\), we have \(\mathbb E[\mathbb E[X \vert \mathcal H] \vert \mathcal G] = \mathbb E[X \vert \mathcal G]\).</p> <p>What does \(\mathcal G \subset \mathcal H\) mean? In the discrete case where \(\mathcal G = \sigma(G_1, \dots, G_n)\) and \(\mathcal H = \sigma(H_1, \dots, H_m)\), we have \(G_k = \dot \cup_{j \in J(k)} H_j\) where \(J(1),\dots, J(n)\) is a partition of \(\{1, \dots, m\}\).</p> <p>Now, to show the tower property,</p> \[\begin{align*} \mathbb E[X \vert G_k] &amp;= \underbrace{\mathbb E[X; G_k]}_{P(G_k)} \\ &amp;= \sum_{j \in J(k)} \underbrace{\mathbb E(X; H_j)}_{P(H_j)}P(H_j \vert G_k) \\ &amp;= \sum_{j \in J(k)} \mathbb E(X \vert H_j)P(H_j \vert G_k) \end{align*}\] <p>In the trading strategy context, we have \(\mathcal F_0 \subset \mathcal F_1 \subset \dots \subset \mathcal F_n\).</p> <h3 id="martingales">Martingales</h3> <p>We now introduce Martingales formally - A Martingale is a sequence of random variables \(\{M_0, \dots, M_T\}\) such that</p> <ol> <li> <p><em>Adapted:</em> \(M_t \in \mathcal F_t\), for all \(t\)</p> </li> <li> <p><em>Integrable:</em> \(\mathbb E(\vert M_t\vert) &lt; \infty\) for all \(t\)</p> </li> <li> <p>\(\mathbb E(M_t \vert \mathcal F_{t - 1}) = M_{t - 1}\), \(1 \leq t \leq T\). From Tower law, \(\mathbb E[M_T \vert \mathcal F_s] = M_s\).</p> </li> </ol> <p>Let us now revert to our discussion on trading strategies with these formal definitions in mind.</p> <p>As we have seen before in #General \(T\), \(\phi\) that satisfied \(V_t^*(\phi) := V_t(\phi)/(1 + r)^t\) is a \(p^*\)-martingale, where \(p^* = \frac{1 + r - d}{u - d}\). A special case of this is \(S^*_t\) is a \(p^*\)- martingale. We have the following theorem,</p> <p><strong>Theorem 2. (General \(T\))</strong> \(V_0\) is the arbitrage-free price of \(V\)</p> <p><em>Proof.</em> We follow a similar structure as before,</p> <ol> <li> <p>\(C_0 \neq V_0\), then arbitrage is available</p> </li> <li> <p>\(C_0 = V_0\), we have for any strategy \(\psi = \{(\alpha_t, \beta_T, \gamma_1): t = 1, \dots, T\}\), \(V_0(\psi) = 0, V_T(\psi) \geq 0\) due to self-financing. Let \(\bar \phi = \{(\bar \alpha_t, \bar \beta_T): t = 1, \dots, T\}\) be the hedge for \(X\). Then, \(V_T(\bar \phi) = X\) and \(V_0(\bar \phi) = V_0\).</p> \[\begin{align*} V_0 (\psi) &amp;= \alpha_1 S_0 + \beta + \gamma_1 C_0 \\ V_T(\psi) &amp;= \alpha_T S_t + \beta_T B_T + \gamma_1 X \end{align*}\] <p>Continuing the calculations,</p> \[\begin{align*} \mathbb E^*(V^*_T(\psi)) &amp;= \mathbb E^*(\alpha_T S^*_T + \beta_T + \gamma_1 X^*) \\ &amp;= \mathbb E^*(V_T(\phi)) + \gamma_1 \mathbb E^*(X^*) \\ &amp;= V_0(\phi) + \gamma_1 C_0 \\ &amp;= V_0 (\psi) = 0 \implies V_T(\psi) = 0 \end{align*}\] <p>Therefore, no arbitrage is possible in this case.</p> </li> </ol> <p>Let us consider a numerical example to understand this better - Consider the call option \(X = (S_T - K)^+\), where \(T = 4, u = 1.2, d = 0.8, r = 0\) (\(p^* = 0.5\)). Let \(S_0 = 50\) and \(K = 40\). What is the fair price of \(X\)?</p> <p>Then, we have the following evolution for \(S_T\),</p> \[\begin{align*} &amp;50\\ 40&amp;\quad 60\\ 32\quad &amp;48\quad 72\\ 25.6\quad 38.4&amp;\quad 57.6\quad 86.4\\ 20.48\quad 30.72\quad &amp;46.08\quad 69.12\quad 103.68 \end{align*}\] <p>Consequently, the tree for \(V_0\) is</p> \[\begin{align*} &amp;13.54\\ 1&amp;\quad 21.66\\ 1.52\quad &amp;10.32\quad 32\\ 0\quad 3.04&amp;\quad 17.6\quad 46.4\\ 0\quad\quad 0 \quad &amp;6.08\quad 29.12 \quad 63.68 \end{align*}\] <p>We construct the tree recursively, starting from the bottom-most level. At time \(T\), we know \(V_T\), and then we use \(V_t^u p^* + V_t^d(1 - p^*)\) to get \(V_{t - 1}(1 + r)\).</p> <h2 id="call-put-parity">Call-Put Parity</h2> <p>A call option is represented as \(C_T = (S_T - K)^+\) and a put option is represented as \(P_T = (K - S_T)^+ = (S_T - K)^-\).</p> <p>For any \(b\), we have \(b^+ - b^- = b\) and \(b^+ + b^- = b\). In other words, the payoffs in call and put options are related to each other as</p> \[\begin{align*} C_T - P_T = S_T - K \\ C_T + K = S_T + P_T \end{align*}\] <p><strong>Claim.</strong> For \(t &lt; T\), we have</p> \[C_t + \frac{K}{(1 + r)^{T - t}} = S_t + P_t\] <p>This result can be proved using <strong>One price principle</strong>. Think of each side of the equation as separate investments</p> <ol> <li> <p>First investment has a call option and bonds with \(K\).</p> </li> <li> <p>Second investment has a put option and one share of the stock</p> </li> </ol> <p>We can see that at time \(T\), the values become equal \(C_T + K = S_T + P_T\)</p> <h1 id="american-options">American Options</h1> <p>In American Options, we have \(Y_0, Y_1, \dots, Y_T\) random payouts where each \(Y_t \in \mathcal F_T\). The holder of the options can take the payment at any time \(t \in [0, T]\) of choice. That is , unlike European options, American options have the choice of payment at any intermediate time. For example, consider a call option \(Y_t = (S_t - K)^+\) for \(t = 0, \dots, T\).</p> <p>Formally, we have the <strong>stopping time</strong> property represented as \(\mathcal T: \Omega \to \{0, 1, \dots, T\}\) such that \(\{\mathcal T \leq t\} = \{w \in \Omega: \mathcal T(W) \leq t\} \in \mathcal F_t, \forall t = 0, 1, \dots, T\). This is equivalent to saying, \(\{T = t\} \in \mathcal F_t, \forall t\).</p> <p>For example, consider \(Z_0, Z_1, \dots, Z_T\), we have \(\mathcal T:= \min \{t: Z_T \in B\} \wedge T\) where \(A \wedge b = \min(a, b)\). Then, \(\{\mathcal T = t\} = \{Z_) \not\in B, Z_1 \not\in B, \dots, Z_{t - 1} \not \in B, Z_t \in B\} \in \mathcal F_t\).</p> <h2 id="optional-stopping-theorem">Optional Stopping Theorem</h2> <p>Consider a stopping time \(\tau\) and a Martingale \((M_t)\), we have \(\mathbb E(M_\tau) = \mathbb E(M_0)\). Essentially, in a fair game, the average payout from exiting the option at an intermediate time is the same as the average payout till time \(t= T\).</p> <p>Here \(M_\tau\) is a random variable of the form \(M_{\tau(w)}(w)\) which we have represented in a singular form.</p> <p>Is the converse true? That is, a sequence of random variables have the optional stopping property where expectations are the same for the beginning and an intermediate time. Then do they constitute a Martingale? Yes, we have</p> \[\begin{align*} M_T &amp;= M_0 + \sum_{t = 1}^T (M_t - M_{t - 1}) \\ M_\tau &amp;= M_0 + \sum_{t = 1}^T (M_t - M_{t - 1}) \mathbb 1_{\{t \leq \tau\}} \end{align*}\] <p>The event \(\{t \leq \tau\}\) is equivalent to \(\{\tau \leq t - 1\}^c\). This allows us to get back the notion of \(\mathcal F_{t - 1}\)</p> \[\begin{align*} \mathbb E(M_\tau) &amp;= \mathbb E(M_0) + \sum_{t = 1}^T \mathbb E[(M_t - M_{t - 1} \mathbb 1_{\{t \leq \tau\}}] \\ &amp;= \mathbb E(M_0) + \sum_{t = 1}^T \mathbb E[\mathbb E[(M_t - M_{t - 1} \mathbb 1_{\{t \leq \tau\}} \vert \mathcal F_{t - 1}]] \\ &amp;= \mathbb E(M_0) + \sum_{t = 1}^T \mathbb E[\mathbb E[(M_t - M_{t - 1} \vert \mathcal F_{t - 1}] \mathbb 1_{\{t \leq \tau\}}] \\ &amp;= \mathbb E(M_0) \end{align*}\] <p>Let us consider an example of an American Put option to understand this better -</p> \[Y_t = (K - S_t)^+\] <p>where \(T = 1, u = 2, d = 0.5, r = 0.2, S_0 = 100, K = 150\). The value for \(p^*\) is \(7/15\). Then, we have the following tree evolution for \(S_t\)</p> \[\begin{align*} &amp;100 \\ 50 &amp;\quad 100 \\ 25 \quad 100 &amp;\quad 100 \quad 400 \end{align*}\] <p>The payment \(Y_t\) looks like</p> \[\begin{align*} &amp;50 \\ 100^{1} &amp;\quad 0 \\ 125 \quad 50 &amp;\quad 50 \quad 0 \end{align*}\] <p>How do we calculate a fair price in this case? We introduce the notion of a <strong>super-martingale</strong>. In comparison, in European call options, we get for \(V_t\)</p> \[\begin{align*} &amp;41.98 \\ 75^{1} &amp;\quad 22.\bar 2 \\ 125 \quad 50 &amp;\quad 50 \quad 0 \end{align*}\] <p>From the seller’s perspective, we have \(U_t\), and we use something called as a <strong>necessary wealth</strong> process - calculating the amount of money the seller requires at every node to pay the option holder. To do so, we need to consider the maximum of all possible payouts at every node. In the node labeled \(1\) above, if the buyer exits the option at \(t = 1\), then the seller needs a payout of \(100\). However, if the buyer exits at time \(t = 2\), the seller requires atleast \(75\) at \(t = 1\) (They can invest the \(75\) in the same stock using short sell to get the required payouts). Considering these scenarios, the seller requires \(100\) at the \(1\) node. Doing such a process for every node, we get \(U_t\)</p> \[\begin{align*} &amp;53.09 \\ 100 &amp;\quad 22.\bar 2 \\ 125 \quad 50 &amp;\quad 50 \quad 0 \end{align*}\] <p>We can see that the price of this option is slightly higher than European since the buyer has the choice of exiting the contract at any intermediate time.</p> <p>To formally describe the process we did above, we consider the following <em>recursion</em></p> \[\begin{align*} U_{t - 1} &amp;= \max \left(\frac{1}{1 + r} \mathbb E^*(U_t \vert \mathcal F_{t - 1}), Y_{t - 1}\right) \quad t = T, T - 1, \dots, 1 \\ U^*_{t - 1} &amp;= \max\left(\mathbb E^*(U^*_t \vert \mathcal F_{t - 1}), Y^*_{t - 1}\right) \\ &amp;\geq \mathbb E^*(U^*_t \vert \mathcal F_{t - 1}) \end{align*}\] <p>The variables \(U^*_{t} = U_t (1 + r)\) are called as <strong>super-martingales</strong>.</p> <p>Let us now delve deeper into the <em>necessary wealth</em> argument.</p> <h2 id="necessary-wealth">Necessary Wealth</h2> <p>We have \(Y = \{Y_0, \dots, Y_T\}\) representing the random variable for the payouts at each time \(t\). We formulated that</p> \[\begin{align*} U_T := Y_T \\ U_{t - 1} := \max\left(\frac{1}{1 + r} \mathbb E^*(U_t \vert \mathcal F_{t - 1}), Y_{t - 1}\right) \end{align*}\] <p>for \(t = T, T - 1, \dots, 1\). For each \(U_{t - 1}\),</p> \[\begin{align*} U_{t - 1} &amp;\geq \frac{1}{1 + r} \mathbb E^*(U_T \vert \mathcal F_{t - 1}) \\ U^*_{t - 1} &amp; \geq \mathbb E^*(U_t^* \vert \mathcal F_{t - 1}) \end{align*}\] <p>\(\{U_T^*: t = 0, 1, \dots, T\}\) form a \(p^*\)-supermartingale. Also note that, \(U^*_t \geq Y^*_t\) for \(t = 0, 1, \dots, T\). It is called as a <strong>Snell Envelope</strong> of \(\{Y_t\}\).</p> <p>Consider the probability space \((\Omega, \mathcal F, P)\) with the event spaces \((\mathcal F_t)_{t = 0}^T\). Then, we have the following claim -</p> <p><strong>Claim.</strong> There does not exist a supermartingale \((Z_t)\) such that</p> <ol> <li> <p>\(Z_t \geq Y_t\), for all \(t\)</p> </li> <li> \[Z_t = \max_{t \leq \tau \leq T} \mathbb E(Y_\tau \vert \mathcal F_t)\] </li> <li> <p>The maximum in the above equation is attained at \(\tau^*(t) = \min(s \geq t: Z_s = Y_S) \wedge T\)</p> </li> <li>The random variables \(Z_{T \wedge \tau^*(0)}\) for \(t = 0, 1, \dots, T\) is a martingale.</li> </ol> <p><strong><em>Proof.</em></strong> Define \(Z_t := \max_{t \leq \tau \leq T } \mathbb E(Y_T \vert \mathcal F_t)\). We can compute \(Z_t\) since it is a finite optimization problem. Since \(\{Y_t\}\) form a martingale, we get</p> \[Z_t \geq \mathbb[Y_T \vert \mathcal F_t] = Y_t\] <p>We use this result to show that \(Z_t\) form a supermartingale. Consider the stopping time \(\sigma\) between \(t\) and \(T\). Then, for attaining maximum</p> \[\begin{align*} Z_t &amp;= \mathbb E[Y_\sigma \vert F_t ]\\ \mathbb E[Z_t \vert \mathcal F_{t - 1}] &amp;= \mathbb E[\mathbb E[Y_\sigma \vert \mathcal F_t ] \vert \mathcal F_{t - 1}] \\ &amp;= \mathbb E[Y_\sigma \vert \mathcal F_{t - 1}] \leq Z_{t - 1} \end{align*}\] <p>How do we now show that this is minimal? \(Z_t\) being minimal implies that if \(Z_t\) is a supermarginale majorant of \(\{Y_t\}\), then \(X_t \geq Z_t\) for all \(t\).</p> \[\begin{align*} X_t(w) \geq Y_t(w) \forall t, \forall w \\ \implies X_{\tau(w)} (w) \geq Y_{\tau(w)}(w) , \forall w\end{align*}\] <p>Then, equivalently, \(X_\tau \geq Y_\tau\) for \(t \leq \tau \leq T\).</p> \[\begin{align*} X_t &amp;\geq \mathbb E(X_t \vert \mathcal F_t) \geq \mathbb E[Y_T \vert \mathcal F_t] \\ &amp;\geq \mathbb E[Y_T \vert \mathcal F_t], \forall t \end{align*}\] <p>Resulting in \(X_t \geq Z_t\). So far, we have shown (1) and (2) in the claim. Also, in the above proof, we use the following property. Let \(X_t\) be a supermartingale ifor \(t \leq \tau \leq T\). Then \(\mathbb E(X_\tau \vert \mathcal F_t) \leq X_t\). The proof is left as an exercise.</p> <p>How do we show (3) and (4) in the claim. For (4), we simply need to check the martingale property</p> \[\begin{align*} \mathbb E[Z_{(t + 1) \wedge \bar \tau} - Z_{t \wedge \bar \tau} \vert \mathcal F_t] &amp;\stackrel{?}{=} 0 \\ &amp;= \mathbb E[\mathbb 1_{t &lt; \bar \tau}(Z_{(t + 1) \wedge \bar \tau} - Z_{t \wedge \bar \tau} \vert \mathcal F_t] \\ &amp;= \mathbb E[\mathbb 1_{t &lt; \tau} (Z_{t + 1} = Z_t) \vert \mathcal F_t] \\ &amp;= \mathbb 1_{t &lt; \bar \tau} \left(\mathbb E(Z_{t + 1} \vert F_t) - Z_t\right) \\ \end{align*}\] <p>where \(\bar \tau(w) = \tau^*(0) (w)\). Now, rewriting the definition of \(Z_t\), we get</p> \[Z_t = \max \left(\mathbb E(Z_{T + 1} \vert \mathcal F_t, Y_t\right)\] <p>meaning for \(t &lt; \bar \tau \implies Z_t &gt; Y_t\) (from definition of \(\bar \tau\) in (3)) implying \(Z_t = \mathbb E(Z_{t + 1} \vert \mathcal F_t)\). This proves the required property.</p> <p>The last argument is to show that, given a supermartingale \(\tilde Z\) with \(\tilde Z_t \geq Y_t\) for all \(t\), then \(\tilde Z_t = Z_t\) for all \(t\). This proves uniqueness.</p> <p>We have</p> \[\begin{align*} \tilde Z_{t - 1} &amp;= \max(Y_{t - 1}, \mathbb E(\tilde Z \vert \mathcal F_{t - 1})) \\ &amp;\leq \max(Y_{t - 1}, \mathbb E(Z_t \vert \mathcal F_{t -1})) \\ &amp;\leq \max(Y_{t - 1}, Z_{t - 1}) = Z_{t - 1} \end{align*}\] <p>We have already shown that \((Z_t)_{t - 0}^T\) is the least supermartingale majorant of \((Y_t)_{t = 0}^T\). This proves uniqueness.</p> <h2 id="pricing-an-american-call">Pricing an American Call</h2> <p>Can we find a \(\phi^*\) such that \(V_t(\phi^*) \geq U_t\). We had derived the following before</p> \[\begin{align*} \tilde \alpha_t = \frac{U^u_t - U^d_t}{u - d} \frac{1}{S_{t - 1}} \\ \tilde \beta_t = \frac{uU^d_t - dU^u_t}{u - d} \frac{1}{B_{t - 1}} \end{align*}\] <p>An important to thing to note here is that these values are random variables and are measurable under \(\mathcal F_{t - 1}\). However, this strategy will not be self-financed due to the super-martingale property. The value of the portfolio is</p> \[\tilde \alpha_t S_t + \tilde \beta_t B_t \equiv U_t\] <p>Then we have,</p> \[\begin{align*} U_{t - 1} &amp;= Y_{t - 1} \vee \left(\frac{1}{1 + r} \mathbb E^*(U_t \vert \mathcal F_{t - 1})\right)\\ \tilde \delta_t &amp;:= U_{t - 1} - \frac{1}{1 + r} \mathbb E^*(U_t \vert \mathcal F_{T - 1}) \geq 0 \\ &amp;\because \tilde \delta_t \geq 0 \Leftrightarrow Y_{t - 1} &gt; \frac{1}{1 + r} \mathbb E^*(U_T \vert \mathcal F_{t - 1}) \end{align*}\] <p>Now, consider the following strategy</p> \[\begin{align*} \alpha^*_t &amp;= \tilde \alpha_t \\ \beta_t^* &amp;= \tilde \beta_t + \sum_{s = 1}^t \tilde \delta_s/B_{s - 1} \geq \tilde \beta_t \end{align*}\] <p>This trading strategy \(\phi^* = \{(\alpha^*, \beta^*): t = 1, \dots, T\}\) is a <strong>super-hedging strategy</strong> with \(V_t(\phi^*) \geq U_t\). We introduced \(\tilde \delta_t\) to make it a self-financing strategy.</p> <p>Define \(\bar \tau = \bar \tau(0) = \min(T: U_t = Y_T) \wedge T\). Then, \(U_{t - 1} &gt; Y_{t - 1}\) and \(\tilde \delta_t = 0\) for \(t = 1, \dots, \bar \tau(w)\). Consequently, \(V_{t \wedge \tau}(\phi^*) = U_{t \wedge \tau}\), and \(U^*_{t \wedge \tau} = \frac{U_{t \wedge \tau}}{(1 + r)^{t \wedge \tau}}\) forming a martingale.</p> <h2 id="arbitrage-1">Arbitrage</h2> <p>For a trading strategy \(\psi\), we have \(V_0(\psi) = 0\) and \(V_T(\psi) \geq 0\). Alternately, \(P(V_T(\psi) &gt; 0) &gt; 0\). In an American option, there is an asymmetry between the buyers and the sellers. The buyer has to choose only one time \(t \leq T\) to exit the option whereas the seller has to safeguard against an arbitrage in all possibilities.</p> <p>The <strong>seller’s arbitrage</strong> for a strategy \(\phi^s\) (in stocks and bonds) is then defined as</p> \[\begin{align*} V_0(\phi^s) &amp;= C_0 \\ \forall \tau V_\tau(\phi^s) &amp;\geq Y_\tau \\ &amp;&gt; \quad \quad \text{sometimes} \end{align*}\] <p>The seller sells an option for \(C_0\) and makes an investment of \(C_0\) in \(\phi_s\). Then an arbitrage for the seller is</p> \[V_T = (V_\tau(\phi^s) - Y_\tau)(1 + r)^{T - \tau}\] <p>where \(\tau\) is the time when the buyer exits the option. This value is always greater than or equal to \(0\) with a non-zero probability that it is strictly greater than \(0\).</p> <p>On the other hand, the <strong>buyer’s arbitrage</strong> for a strategy \(\phi_b\) is defined as</p> \[\begin{align*} V_0(\phi^b) &amp;= -C_0 \\ \exists \tau V_\tau(\phi^b) + Y_\tau &amp;\geq 0 \\ &amp;&gt; \quad \quad \text{sometimes} \end{align*}\] <p>The arbitrage at time \(T\) is \((V_\tau(\phi^b) + Y_\tau)(1 + r)^{T - \tau}\).</p> <p>What would be the good time to exercise the option? In the following sections, we’ll see that \(\tau = \bar \tau\) is the optimal time to exit the option.</p> <h3 id="example">Example</h3> <p>Consider a put option \(Y_T = (K - S_t)^+\) where \(K = 150, S_0 = 100, u = 2, d = 0.5, r = 0.2, T = 2\). We get \(U_0 = 53.09\) and \(Y_0 = 50\). Then, the super-hedging strategy is given by</p> \[\begin{align*} \end{align*}\] <p>To summarise, for a payout random variable \(Y = \{Y_0, \dots, Y_T\}\), we have \(U_t\) as the necessary wealth at each time \(t\). Then, the super-hedging strategy \(\phi^*\) has the following properties -</p> <ul> <li> <p>\(V^*_t(\phi^*)\) is a martingale</p> </li> <li> <p>\(V^*(\phi^*) \geq U^*_t \geq Y^*_t\) for all \(t\)</p> </li> </ul> <p>We define \(\bar \tau\) such that \(\bar \tau = \min\{t \vert U_t = Y_t) \wedge T\). With this definition, we have</p> \[V_t^*(\phi^*) = U_t^*\] <p>for \(t = 0, 1, \dots, \bar \tau\) and \(V_0(\phi^*) = U_0\).</p> <p><strong>Theorem.</strong> \(U_0\) is the no-arbitrage price for American call option based on \(Y\).</p> <p><em>Proof.</em></p> <ol> <li> <p>\(C_0 &gt; U_0\), then there’s arbitrage for the seller. The seller sells the claim for \(C_0\) and buys \(\phi^*\) for \(U_0\). The remaining amount, \(C_0 - U_0\) is invested in bonds. Then, for this strategy \(\phi^s\), we have</p> \[\begin{align*} V_t(\phi^s) &amp;= V_t(\phi^*)+ (C_0 - U_))B_t \\ V_\tau(\phi^s &amp;= V_\tau(\phi^*) + \underbrace{(C_0 - U_0)B_\tau}_{&gt;0} \\ &amp;\geq U_\tau + \dots \\ &amp;\geq Y_\tau + \dots \end{align*}\] </li> <li> <p>\(C_0 &lt; U_0\), we have a buyer’s arbitrage for the strategy \(\phi^b\)</p> \[\phi^b = \begin{cases} -U_0 &amp; \text{in } -\phi^* \\ U_0 - C_0 &amp; \text{in bond} \end{cases}\] <p>Then,</p> \[\begin{align*} V_0(\phi^b) &amp;= -C_0 \\ V_\tau(\phi^b) &amp;= - V_\tau(\phi^*) + (U_0 - C_0)B_\tau \end{align*}\] <p>Using \(\tau = \bar \tau\),</p> \[\begin{align*} V_{\bar \tau}(\phi^b) + Y_{\bar \tau} &amp;= -V_{\bar \tau}(\phi^*) + (U_0 - C_0)B_{\bar \tau} + Y_{\bar \tau} \\ &amp;= (U_0 - C_0) B_{\bar \tau} &gt; 0 \end{align*}\] </li> <li> <p>\(C_0 = U_0\). We need to show separately that there’s no seller’s and buyer’s arbitrage</p> <ol> <li> <p>No seller’s arbitrage - Suppose \(\phi^s\) is a seller’s arbitrage strategy. We have</p> \[V_0(\phi^s) = C_0, V_\tau(\phi^s) \geq Y_\tau\] <p>Note that all elements need not be strictly greater for an arbitrage. Computing the expectation,</p> \[\mathbb E^*(Y^*_\tau) &lt; \mathbb E^*(V^*_\tau(\phi^s)) = V_0(\phi^s) = U_0 = C_0\] <p>for all stopping times \(\tau\). However,</p> <blockquote> <p>why strictly less than in the above equation?</p> </blockquote> \[\mathbb E^*(Y^*_\tau) = \mathbb E^*(V_\tau^*(\phi^s)) = V_0(\phi^s) = C_0\] <p>This shows that no seller’s arbitrage is possible.</p> </li> <li> <p>No buyer’s arbitrage - Suppose \(\phi^b\) is such that</p> \[\begin{align*} V_0(\phi^b) &amp;= -C_0 \\ \exists \tau_0 V_{\tau_0} (\phi^b) + Y_{\tau_0} &amp;\geq 0 \quad (&gt; 0 \text{ sometimes}) \end{align*}\] <p>Then, computing the expectation</p> \[\begin{align*} \mathbb E^*(V^*_\tau(\phi^b)) &amp;= V_0(\phi^b) = -C_0 \\ \mathbb E^*(V_\tau^*(\phi^b) + Y_\tau^*) &amp;= -C_0 + \mathbb E^*(Y^*_\tau) \\ &amp;\leq -C_0 + \mathbb E^*(U^*_\tau) \\ &amp; \leq -C_0 + U_0 = 0 \end{align*}\] <p>This shows that no buyer’s arbitrage is possible. \(\square\)</p> </li> </ol> </li> </ol> <h3 id="example-1">Example</h3> <p>Consider anMerican Call \(S_0 = 4, r = 0.25, u = 2, d = 0.5, K = 4, T = 3\). This yields \(p^* = 0.5\). We have the following</p> \[S_t \implies \begin{align*} &amp;4 \\ 2 &amp;\quad 8 \\ 1 \quad &amp;4 \quad 16 \\ 0.5 \quad 2 &amp;\quad 8 \quad 32 \end{align*}\] \[Y_t \implies \begin{align*} &amp;0 \\ 0 &amp;\quad 4 \\ 0 \quad &amp;0 \quad 12 \\ 0 \quad 0 &amp;\quad 0 \quad 28 \end{align*}\] \[U_t = V_t \implies \begin{align*} &amp;\frac{64}{5} \\ \frac{16}{25} &amp;\quad \frac{144}{25} \\ 0 \quad &amp;\frac{8}{5} \quad \frac{64}{5} \\ 0 \quad 0 &amp;\quad 4 \quad 28 \end{align*}\] <h2 id="american-call-put-parity">American Call-Put Parity</h2> <p>The relation between call and put options in general can be shown using <strong>Jensen’s inequality</strong>. We have</p> \[\begin{align*} \mathbb E(\phi(X)) &amp;\geq \phi(\mathbb E(X)) \\ \mathbb E(\phi(X \vert \mathcal G)) &amp;\geq \phi(\mathbb E(X | \mathcal G)) \end{align*}\] <p>The payout functions for both call and put options are convex. We aim to show that \(U_t = V_t\) for \(t = T, T - 1, \dots, 1, 0\), using induction. The statement is true for \(t = T\).</p> <p>ASsume \(U_s = V_s\) for \(s = t, t + 1, \dots, T\), then</p> \[\begin{align*} U_{t - 1} &amp;= \max \left(Y_{t - 1} , \frac{1}{1 + r} \mathbb E^*(U_t \vert \mathcal F_{T - 1})\right)\\ &amp;= \max \left(Y_{t - 1} , \frac{1}{1 + r} \mathbb E^*(V_t \vert \mathcal F_{T - 1})\right)\\ \end{align*}\] <p>Substituting \(V_t = \frac{1}{(1 + r)^{T - \tau}} \mathbb E^*(V_t \vert \mathcal F_t)\),</p> \[\begin{align*} \mathbb E^*(V_t \vert \mathcal F_{t - 1}) &amp;= \frac{1}{(1 + r)^{T - t}} \mathbb E^*(V_T \vert \mathcal F_{t - 1}) \\ &amp;= \frac{1}{(1 + r)^{T - t}} \mathbb E^*((S_T - K)^+ \vert \mathcal F_{T - 1}) \\ &amp;\geq \frac{1}{(1 + r)^{T - t}} \left(\mathbb E^*(S_T \vert \mathcal F_{t - 1}) - K\right)^+ &amp; \because \text{Jensen's inequality}\\ &amp;= \frac{1}{(1 + r)^{T - t}} ((1 + r)^{T - t + 1}S_{t - 1} - K)^+ \\ &amp;= (1 + r)\left( S_{t - 1} - \frac{K}{(1 + r)^{T - t + 1}}\right)^+ \\ &amp;\geq (1 + r) (S_{t - 1} - K)^+ \\ &amp;= (1 + r) Y_{t - 1} \end{align*}\] <p>Using this result above, we have</p> \[\begin{align*} U_{t - 1} &amp;= \max \left(Y_{t - 1} , \frac{1}{1 + r} \mathbb E^*(V_t \vert \mathcal F_{T - 1})\right)\\ &amp;= \frac{1}{1 + r} \mathbb E^*(V_t \vert \mathcal F_{T - 1}) = V_{t - 1} \end{align*}\] <h1 id="finite-market-models">Finite Market Models</h1> <p>The binomial model we have discussed previously is an example of a finite market model. These structures can be generalised to markets with multiple stocks, bonds and contingent claims. The price evolution need not be binary We shall derive results for pricing similarly like before for this general market. To do the analysis, the notation for probability space, portfolio, value, trading strategies and arbitrage has to be defined -</p> <h4 id="probability-space">Probability Space</h4> <p>Again, we consider a finite probability space \((\Omega, \mathcal F, P)\), that is \(\#(\Omega)&lt; \infty)\) with \(\mathcal F = \mathcal P(\Omega)\) (the power set) and \(P(A) = \sum_{w \in A} P(w), A \in \mathcal F\).</p> <p>We shall assume that every event has a non-zero probability. If there are events with zero-probability, they are not relevant to our discussion and we can simply prune these points.</p> <p>A <strong>filtration</strong> \(\mathcal F_0 \subset \mathcal F_1 \subset \cdots \subset \mathcal F_T\) represents the history of the market or the evolution of prices of assets in the market. Typically, \(\mathcal F_T = \mathcal F\).</p> <h4 id="assets-in-portfolio">Assets in portfolio</h4> <p>Now in this setup, we consider the assets - asset 0 bond and assets \(1, 2, \dots, d\) stocks. At any time \(t\), the prices are given by</p> \[S_t = (S^0_t, S^1_t, \dots, S^d_T), t = 0, 1, \dots, T\] <p>Where \(S^0_t\) is the bond-price and not random and \(S_t^U\) for \(i &gt; 0\) represent the stock prices.</p> <p>Each sequence \(\{S_t^i\}_{t = 0}^T\) is \(\mathcal F_t measurable\), that is \((S_t)\) is adapted to the filtration.</p> <h4 id="trading-strategy">Trading strategy</h4> <p>After defining the prices and the structure of the portfolio, we define a <em>trading strategy</em> for this market -</p> \[\phi = \{\phi_t: t = 1, \dots, T\}\] <p>where \(\phi_t = (\phi_t^0, \phi_t^1, \dots \phi_t^d)\) is a vector of holdings representing the assets held at time \(t\). That is, \(\phi_t^I\) is the number of shares of asset \(i\) to be held on day \(t\).</p> <p>The basic assumptions with our trading strategies are</p> <ul> <li>The trading strategy is predictable - \(\phi_t^i \in \mathcal F_{t - 1}\) for all \(i\) and \(t = 1, 2, \dots, T\).</li> <li>Self-financing - \(\phi_t \cdot S_t = \phi_{t + 1} \cdot S_t\) (note that these are vector dot products \(\phi_t \cdot S_t = \sum_{i = 1}^d \phi_t^i S_t^i\)).</li> </ul> <h4 id="value-of-the-portfolio">Value of the portfolio</h4> <p>The value of the portfolio at time \(t = 0\) is given by \(V_0(\phi) = \phi_1 \cdot S_0\) and for time \(t &gt; 0\), we have \(V_t(\phi) = \phi_t \cdot S_t\). For this market, the change in the value of portfolio across a day is given by \(\Delta V_t(\phi)\)</p> \[\begin{align*} \Delta V_t(\phi) &amp;:= V_t(\phi) - V_{t - 1}(\phi) \\ &amp;= \phi_t \cdot S_t - \phi_{t - 1}\cdot S_{t - 1} \\ &amp;= \phi_t \cdot (S_t - S_{t - 1}) \\ &amp;= \phi_t \cdot \Delta S_t \end{align*}\] <p>So the value at any time \(t\) can now be defined as</p> \[\begin{align*} V_t(\phi) &amp;= V_0(\phi) + \sum_{u = 1}^t \sum_{i = 0}^d \phi_u^i \Delta S_u^i \quad \quad\because \quad \text{Telescoping sum} \\ &amp;=V_0(\phi) + \sum_{u = 1}^t \phi_u \cdot \Delta S_u \end{align*}\] <p>for \(t = 0, 1, \dots, T\)</p> <p>To help us derive results in the later sections, we define the following notation for <strong>discounted stock prices</strong> -</p> \[\begin{align*} S_t^* &amp;= S_t /S^0_t \\ &amp;= (1, S_t^{1*}, \dots, S_t^{d*}) \end{align*}\] <p>It essentially divides the stock prices with the bond price at time \(t\). Similarly we can define discounted value of a portfolio.</p> <p>We can derive that the telescopic sum property still holds with the discounted values for the portfolio. That is,</p> \[V_T^*(\phi) = V_0^*(\phi) + \sum_{u = 1}^t \phi_u \cdot \Delta S_u^*\] <p>where \(\Delta S_u^* = S_u^* - S_{u - 1}^*\). This property will be useful for extracting Martingales from the price evolution tree. Specifically, we have the following lemma</p> <p><strong>Lemma 1</strong> If \((M_t: t = 0, 1, \dots, T)\) is a martingale and \((H_1,H_2, \dots, H_T)\) is a predictable sequence of random variables then</p> \[X_t := \sum_{u = 1}^T H_u \Delta M_u\] <p>is a martingale!</p> <h4 id="arbitrage-2">Arbitrage</h4> <p>The expressions are very similar to before wherein an arbitrage opportunity (risk-free profit) is a trading strategy \(\phi\) such that</p> \[\begin{align*} V_0(\phi) &amp;= 0 \\ V_T(\phi) &amp;\geq 0 \\ P(V_T(\phi) &gt; 0) &amp;&gt; 0 \end{align*}\] <p>The last condition essentially ensures that there is atleast one case where the profit is non-zero. Previously, we had used expectation to ensure this using the \(p^*\) model derived using the binomial model. However, we want a general scenario here and an expectation requires an associated probability distribution.</p> <p>The market is set to be <strong>viable</strong> if there are no arbitrage opportunities. We can show that the binomial model considered previously is viable if \(d &lt; 1 + r &lt; u\). So, when is a market non-viable? Consider \(\Omega = \{w_1, w_2\}, T = 1, d = 2\) with the stock price evolution \(S_0^0 = S_1^0 = 1\), \(S_0^1 = S_0^2 = 1\), and</p> <table> <thead> <tr> <th> </th> <th>( w_1 )</th> <th>( w_2 )</th> </tr> </thead> <tbody> <tr> <td>( S_1 )</td> <td>1</td> <td>2</td> </tr> <tr> <td>( S_2 )</td> <td>1</td> <td>3</td> </tr> </tbody> </table> <p>The trading strategy \(\phi = \{(0, -1, 1)\}\) has \(V_1(\phi) \geq 0\) in all entries and \(&gt;0\) in at least one entry.</p> <p>Notice the subtleties in this example. Previously, in the CRR model, we focused on finding an arbitrage-free pricing. We ensured there is no arbitrage in the market with this design. However, considering a trading strategy with only stocks in a bullish market, there is always an opportunity for arbitrage.</p> <p>For trading strategies with only stocks, the problem of finding a trading strategy boils down to solving some linear inequalities.</p> <h2 id="martingale-measure">Martingale Measure</h2> <p>As noted earlier, we will assume that \(P(w) &gt; 0\) or each \(w \in \Omega\). For a new measure \((\Omega, \mathcal F, Q)\), we say that \(Q\) is equivalent to \(P\) (\(Q \sim P\)) if for all \(A \in \mathcal F\)</p> \[Q(A) &gt; 0 \iff P(A) &gt; 0\] <p>With this infrastructure, we are aiming to find a new probability \(Q\) (like \(p^*\) in CRR model) to prove properties in a market.</p> <p><strong>Definition.</strong> A probability \(Q\) on \((\Omega, \mathcal F)\) is a <strong>martingale measure</strong> provided \(\{S_T^{i*}: t = 0, 1, \dots, T\}\) is a \(Q-martingale\) for each stock \(I = 1, \dots, d\).</p> <p>An <strong>equivalent martingale measure</strong> is a probability \(Q\) such that \(Q \sim P\) and \(Q\) is a martingale measure. With these tools, we now define the first fundamental theorem of asset pricing.</p> <h2 id="first-fundamental-theorem-of-asset-pricing">First Fundamental Theorem of Asset Pricing</h2> <p>A market is viable if and only if there exists at least one Equivalent Martingale Measure (EMM).</p> <p>To understand this better, consider the previous example of a market that is not viable. Suppose we have a martingale measure \(Q\), then</p> \[\mathbb E^Q(S_i^1) = S_0^i\] <p>for \(I = 1, 2\) using the martingale property. Letting \(a = Q(w_1), b = Q(w_2)\), we get the linear equations</p> \[\left. \begin{align*} a + 2b &amp;= 1\\ a + 3b &amp;= 1 \end{align*} \right\} b = 0\] <p>Since, $P(w_2) &gt; 0 \not\imply Q(w_2) &gt; 0$$, there cannot exist an Equivalent Martingale Measure in this market.</p> <h4 id="proof">Proof</h4> <p>(\(\Longleftarrow\)) Let \(Q\) be an EMM and \(\phi\) is a strategy making an arbitrage. That is, \(V_0(\phi) = 0, V_T(\phi) \geq 0\)</p> <p>Since \(\{S_t\}_{t = 1}^T\) is a martingale under \(Q\), the sequence \(\sum_{i = 1}^t \phi_u^I \cdot \Delta S_u^{i*}\) for \(t = 0, 1, \dots, T\) is a \(Q\)-martingale.</p> \[\begin{align*} V^*_T(\phi) &amp;:= V_T(\phi)/S_T^0 \\ &amp;= V_0^* + \sum_{u = 1}^T \phi_u \cdot \Delta S_u^* \\ &amp;= 0 + \sum_{u - 1}^T \sum_{i = 1}^d \phi_u^I \cdot \Delta S_u^{i*} \end{align*}\] <p>\(V_t^*\) is also a martingale under \(Q\), implying \(\mathbb E^Q(V_T^*(\phi)) = \mathbb E^Q(V_0^*(\phi)) = 0\). Since \(P \sim Q\), \(P(V_T(\phi) &gt; 0) = 0\).</p> <p>\((\implies)\) Now, we show the opposite direction, that is for a viable market, there exists an EMM.</p> <p>We have \(\#(\Omega) &lt; \infty\), where \(\Omega = \{w_1, w_2, \dots, w_n\}\). Consider a random variable \(X: \Omega \to \mathbb R\), then we have \((X(w_1), X(w_2), \dots, X(w_n) \in \mathbb R^n)\) and a distribution \(Q\) with probabilities \((Q(w_1), \dots, Q(w_n))\). Then, we have</p> \[\mathbb E^Q(V^*_T(\phi)) = \sum_{k = 1}^n Q(w_k) V^*_T(\phi) (w_k) = Q \cdot V^*_T(\phi)\] <p>It suffices to show that there exists a \(Q\) such that \(Q \perp \{V_T^*(\phi): \phi \text{ is a trading strategy with } V_0(\phi) = 0\} \subset \mathbb R^n\}\).</p> <p>We have seen before that as a result of a telscopric sum formulation, \(V^*_T(\phi) = V_0^*(\phi) + \sum_{u = 1}^T \phi_u \cdot \Delta S_u^*\).</p> <p><strong>Lemma 2</strong></p> <p>Suppose a \(M = (M_1, \dots, M_n)\) is an adapted sequence such that</p> \[\mathbb E\left(\sum_{u = 1}^T q_u \cdot \Delta M_u\right) = 0; \quad \Delta M_k = M_k = M_{k - 1}\] <p>for all predictable \((q_1, \dots, q_T)\), then \(M\) is a martingale.</p> <p><em>Proof.</em> To show, \(\mathbb E(M_t \vert \mathcal F_{t - 1}) = M_{t - 1}\) for \(t = 1, 2, \dots, T\). Equivalently, \(\mathbb E(M_t \cdot \mathbb 1_A) = \mathbb E(M_{t - 1} \cdot \mathbb 1_A)\) for all \(A \in \mathcal F_{t - 1}\).</p> <p>If \(X, Y\) are both \(\mathcal G\)-measurable and \(\mathbb E(X \cdot \mathbb 1_A) = \mathbb E(Y \cdot \mathbb 1_A)\) for all \(A \in \mathcal G\), then \(P(X = Y) = 1\) (Consider \(\{X &lt; Y\} = A\)).</p> <p>In our context \(X = \mathbb E(M_t \vert \mathcal F_{t - 1})\) and \(Y = M_{t - 1}\), leading to \(\mathbb (\Delta M_t \cdot \mathbb 1_A) = 0\). Fixing \(t\) and \(A \in \mathcal F_{t - 1}\), let</p> \[q_u = \begin{cases} \mathbb 1_A &amp; u = t \\ 0 &amp; u \neq t \end{cases}\] <p>Consequently,</p> \[\begin{align*} \sum_{u = 1}^T q_u \cdot \Delta M_u = \mathbb 1_A \cdot (M_t - M_{t - 1}) \end{align*}\] <p><strong>Lemma 3</strong> If we have, \(q_t^i \in \mathcal F_{t - 1}\) for \(i = 1, \dots, d\) amd \(t = 1, \dots, T\), then for any \(c \in \mathbb R\), there exists \(\phi^0_t\) for \(t = 1, \dots, T\) such that</p> \[\phi = \{(\phi_t^0, \phi_t^1, \dots, \phi_t^d): t = 1, \dots, T\}\] <p>is a <strong>self-financing</strong> trading strategy and \(V_0(\phi) = c\).</p> <p><strong>Proposition.</strong> Suppose \(Q \sim P\), such that \(\mathbb E^Q(V_T^*(\phi)) = 0\) for all trading strategies \(\phi\) with \(V_0(\phi) = 0\), then \(Q\) is an EMM. That is, we need to show \(S^{1*}_t\) is a Q-martingale. From lemma 2, it is equivalent to showing \(\mathbb E^Q(\sum_{u = 1}^T q_u \cdot \Delta S_u^{1*}) = 0\) for all \((q_1, \dots, q_T)\). Consider the following strategy</p> \[\phi^i_t = \begin{cases} q_t &amp; i = 1 \\ 0 &amp; i = 2, 3, \dots, d \\ \phi_t^0 \text{ from Lemma 3} \end{cases}\] <p>Then,</p> \[\begin{align*} \sum_{u = 1}^T q_u \Delta M_u &amp;= \mathbb 1_A (M_t - M_{t - 1}) \\ V^*_T(\phi) &amp;= \sum_{i = 0}^d \sum_{u = 1}^T (\phi_u^i \cdot S_u^{i*}) \\ &amp;= \sum_{u = 1}^T q_u \cdot \Delta S_u^{1*} \end{align*}\] <p>Now, for all trading strategies with the self-financing property, the set \(L:= {V_T^*(\phi): \phi \text{ with } V_0(\phi) = 0} \subset \mathbb R^n\) is a linear subspace of \(\mathbb R^n\). Similarly, consider the set \(D := \{Y \in \mathbb R^n : Y \geq 0 \text{ with } Y \neq 0\}\).</p> <p>Our goal boils down to show that a viable market exists if and only if \(L \cap D = \phi\). It is equivalent to show \(L \cap F = \phi\) for \(F:= \{Y \in D: \sum_{i = 1}^n Y_k = 1\}\).</p> <h4 id="assume-viability--">Assume viability -</h4> <p>We have noted that \(L\) is a subspace of \(\mathbb R^n\). Also, \(F\) is compact and convex.</p> <p><strong>Lemma.</strong> <strong><em>Separating Hyperplane Theorem</em></strong> For a vector subspace \(L \subseteq \mathbb R^n\) and a compact convex set \(F\), if \(L \cap F = \phi\), then there exists a \(\zeta \in \mathbb R^n\), \(\zeta \neq 0\) such that</p> \[\begin{align*} L &amp;\subset \{t: t \cdot \zeta = 0\} \\ F &amp;\subset \{y: y \cdot z &gt; 0\} \end{align*}\] <p><em>Proof.</em> Let \(G:= F - L = \{f - l: f \in F, l \in L\}\), then \(G\) is convex and closed and \(0 \not \in G\). We choose the vector \(\zeta \in G\) that minimizes \(\|x\|\), \(x \in G\). Now,</p> \[\beta := \inf \{\|x \|: x \in G \}\] <p>then for any sequence \(x_n \in G\) such that \(\|x_n\|\) converges to \(\beta\) (\(\|x_n\| \searrow \beta\)) , using the parallelogram law</p> \[\begin{align*} \|x_n - x_m\|^2 &amp;= 2(\|x_n\|^2 + \|x_m\|^2) - 4\left\|\frac{x_n + x_m}{2}\right\|^2 \\ \end{align*}\] <table> <tbody> <tr> <td>The terms \(|x_n|^2, |x_m|^2\) converge to \(\beta^2\) and the average $$\left</td> <td>\frac{x_n + x_m}{2}\right</td> <td>^2\(goes to\)\beta^2\(leading to\)|x_n - x_m|^2 \to 0\(for\)m, n \to \infty\(and\)x_n \to \zeta\(. Therefore,\){x_n}\(form a Cauchy sequence convergent to some\)\zeta\(. Since\)G\(is closed, this shows the existence of such\)\zeta \in G$$.</td> </tr> </tbody> </table> <p>Now, for any \(x \in G\), \(x \cdot \zeta \geq \|\zeta\|^2\). How do we show this? Consider any arbitrary vector formed by \(x, \zeta\), \(\|\alpha x + (1 - \alpha)\zeta\|^2 - \|\zeta\|^2 \geq 0\) (a quadratic in \(\alpha\), and \(0 \leq \alpha \leq 1\)). For \(\alpha \to 0\), we get</p> \[-2 \|\zeta^2\| + 2(x\cdot \zeta) \geq 0\] <p>Now, in particular, since \(0 \in L\), if \(f \in G\), then \(f \in F\). Consequently, if \(f \in F\), then for any \(\lambda \in \mathbb R, l \in L\), \(f - \lambda l \in G\). We get</p> \[f\cdot \zeta \geq \lambda (l \cdot \zeta) + \|\zeta\|^2\] <p>With the limits of \(\lambda\), we can conclude that \(l \cdot \zeta = 0\). \(\square\)</p> <p>How does this theorem help us show \(L \cap F = \phi\) for a viable market? Consider the EMM \(Q(w_k) = \frac{\zeta_k}{c} &gt; 0\). \(c = \sum_{i = 1}^n \zeta_i\). For a fixed \(k\), consider</p> \[Y_i = \begin{cases} 1 &amp; i = k \\ 0 &amp; i \neq k \end{cases}\] <p>Then for \(Y \in F\), \(Y \cdot \zeta &gt; 0\). Let \(\phi\) be a trading strategy with \(V_0(\phi) = 0\), then</p> \[\begin{align*} \mathbb E^Q(V_t^*(\phi)) &amp;= Q\cdot V^*_T(\phi) \\ &amp;= \frac{1}{c} \left[\zeta \cdot \underbrace{V_t^*(\phi)}_{\in L}\right] = 0 \end{align*}\] <h3 id="completeness-of-a-market">Completeness of a Market</h3> <p>A merket is complete if for every contingent claim \(X \in \mathcal F_T\), there exists a trading strategy \(\phi\) that can be replicate the claim with \(V_T(\phi) \equiv X\).</p> <h2 id="second-fundamental-theorem-of-asset-pricing">Second Fundamental Theorem of Asset Pricing</h2> <p>Assuming the market is viable, then the market is complete if and only if there is a unique EMM for the market.</p> <p><em>Proof.</em></p> <ol> <li> <p>\((\implies)\) Assume that the market is complete. Let \(P_1^*, P_2^*\) be the distinct EMMs. Then for a \(A \in \mathcal F_T\), define \(X:= \mathbb 1_A\). Due to completeness, \(\exists \phi\) with \(V_T(\phi) = \mathbb 1_A\).</p> \[\begin{align*} P_i^*(A) &amp;= \mathbb E_i^*(\mathbb 1_A) \\ &amp;= \mathbb E_1^*(V_T(\phi)) = \frac{S^0_T}{S^0_0} \cdot V_0(\phi) \end{align*}\] <p>Therefore, \(P_1^*(A) = P_2^*(A)\) for all \(A \in \mathcal F_T\) implying that \(P_1^* = P_2^*\).</p> </li> <li> <p>(\(\Longleftarrow\) ) Assuming that there is a unique EMM, we need to show that the market is complete. We do this by proving the contrapositive - a market is incomplete implies that there is no unique EMM for the market. We define</p> \[L:= \{V_T^*(\phi): \phi \text{ self-financing trading strategies }\}\] <p>Now, we show that the market is incomplete if and only if \(L \subsetneq \mathbb R^n\) and \(\exists z \neq 0\) such that \(z \perp L\). Consider the EMM \(Q\) for a viable market. Then, define \(\tilde Q(w_k) = Q(w_k) + c z_k\) for some \(c &gt; 0\). Then,</p> \[\sum_{k = 1}^n \tilde Q(w_k) = \sum_{k = 1}^n Q(w_k) + c (z \cdot \bf{1}) = 1 + 0\] <p>Is \(\bf{1} \in L\)? Yes, the strategy of investing in one bond yields a discounted value of \(1\) at \(T\).</p> </li> <li> </li> </ol> <p>    Now, it is left to show that there exists a \(c\) such that \(\tilde Q(w_k) &gt; 0\). Consider the following formulation</p> \[c:= \frac{1}{2 \max_{1 \leq k \leq n} \left(\frac{\|z_k\|}{Q(w_k)}\right)}\] <p>Then,</p> \[\begin{align*} \frac{1}{2c} &amp;= \max_k \left(\frac{\|z_k\|}{Q(w_k}\right) \\ Q(w_k) &amp;\geq 2c \|z_k\| \\ \tilde Q(w_k) &amp;= Q(w_k) + cz_k \\ &amp;\geq 2c \|z_k\| + cz_k &gt; 0 \end{align*}\] <p>Finally, to show that \(\tilde Q\) is an EMM,</p> \[\begin{align*} \mathbb E^{\tilde Q}(V_T^*(\phi)) &amp;\stackrel{?}{=} 0 \quad \text{ if} V_0(\phi) = 0\\ &amp;= \mathbb E^Q (V_T^*(\phi)) + c z \cdot V_T^*(\phi) \quad \because z \perp L \\ &amp;= 0 \end{align*}\] <p>This proves the second fundamental theorem of asset pricing.</p> <p>Note that if \(Q_1, Q_2\) are two EMMs, then a linear combination of these \(\alpha Q_1(A) + (1 - \alpha) Q_2(A)\) for \(A \in \mathcal F\) and \(0&lt;\alpha&lt;1\) is also an EMM.</p> <h3 id="example-2">Example</h3> <p>For \(T = 1, \Omega = \{w_1, w_2,w_3\}\), let \(S_1^0 = S_0^0 = 1\), \(S_0^1 = 2\) and \(S_1^1 = \begin{pmatrix}1 &amp; 3 &amp; 5\end{pmatrix}^T\). To check if the market is viable, we try and solve for an EMM on this market - Let \(Q = (a, b, c)\), then</p> \[\begin{align*} a + b + c = 1, a &gt; 0,b&gt;0,c&gt;0\\ a + 3b + 5c = 2 \end{align*}\] <p>Solving, we get</p> \[Q^{(c)} = \left(\frac{1}{2} + c, \frac{1}{2} - 2c, c\right)\] <p>for \(0 &lt; c &lt; \frac{1}{4}\). This shows that the market is viable. Also, the market is not viable since there are multiple EMMs possible.</p> <p>For a contingent claim \(X\), we have</p> \[\begin{align*} \mathbb E^{(c)}(X^*) &amp;= \left(\frac{1}{2} + c\right)x_1 + \left(\frac{1}{2} - 2c\right)x_2 + cx_3 \\ &amp;= \frac{x_1 + x_2}{2} + c (x_1 + x_3 - 2x_2) \end{align*}\] <p>That means, when \(x_1 + x_3 - 2x_2\) is \(0\), then the expectation is independent of \(c\) - \(X\) can be replicated in some cases even if the market is incomplete!</p> <p>Let us try an replicate such an \(X\). Consider the bond holdings \(\alpha\) and stock holdings \(\beta\).</p> \[\begin{align*} \alpha S_1^1 + \beta S_1^0 &amp;= X \\ \alpha \begin{pmatrix}1 \\ 3 \\ 5\end{pmatrix} + \beta \begin{pmatrix}1 \\ 1 \\ 1\end{pmatrix} &amp;= \begin{pmatrix}x_1 \\ x_2 \\ x_3\end{pmatrix} \end{align*}\] <p>\(X\) is replicable iff \(X \in \text{span}(\begin{pmatrix}1 &amp; 3 &amp; 5\end{pmatrix}, \begin{pmatrix}1 &amp; 1 &amp; 1\end{pmatrix}) \equiv X \perp \begin{pmatrix}1 &amp; -2 &amp; 1\end{pmatrix}\). This again yields \(x_1 + x_3 - 2x_2\).</p> <p><strong>Theorem.</strong> In a viable and complete market, the number V_0(\phi) is the no-arbitrage price of a European Call Clain X = V_T(\phi).</p> <p><em>Note.</em> We have seen this before in the context of a binomial model, but this theorem is for a general market with discrete possibilities. In our previous proof, we did not use any binomial properties but rather showed the result using martingale properties. The same proof follows for this as well.</p> <p>How do we conclude such results in a general case? Even when the market is incomplete, how do we find contingent claims which can be replicated?</p> <p>Consider the set \(M = \{Q: Q \text{ is an EMM}\} \neq \phi\). Then for any measure in this set,</p> \[\begin{align*} \mathbb E^Q(V_T^*(\phi)) &amp;= V_0^*(\phi) \\ &amp; = \frac{V_0(\phi)}{S_0^0} \end{align*}\] <p>Now, for a contingent claim X, we have</p> \[\begin{align*} V_+(X)&amp;:= \inf \{V_0(\phi):V_T(\phi)\geq X\} \\ &amp;= \min \{V_0(\phi):V_T(\phi)\geq X\} \\ \hline \mathbb E^Q(X^*) &amp;\leq \mathbb E^Q(V_T^*(\phi)) \sout{S_T^0} = V_0(\phi) \frac{\sout{S_T^0}}{S_0^0} \\ &amp;\leq \frac{1}{S_0^0} V_+(X) \end{align*}\] <p>Similarly,</p> \[\begin{align*} V_-(X)&amp;:= \sup \{V_0(\phi):V_T(\phi)\leq X\} \\ &amp;= \max \{V_0(\phi):V_T(\phi)\leq X\} \\ \hline \\ V_-(X) &amp;\leq S_0^0 \mathbb E^Q(X^*) \leq V_+ (X) \end{align*}\] <p>Suppose \(X\) is replicable, then \(X = V_T(\tilde \phi)\) for some \(\tilde \phi\). Then,</p> \[\begin{align*} V_0(\tilde\phi) \geq V_+(X), V_0(\tilde\phi) \leq V_-(X) \\ V_-(X) \leq V_+(X) \end{align*}\] <p>leading to \(V_+(X) = V_-(X)\)!</p> <p>Does the converse hold? In the previous example, say we have a contingent claim \(X = \begin{pmatrix}1 &amp; 9 &amp; 25\end{pmatrix} = (S_1^1)^2\). Now consider a strategy \(\phi = (\alpha, \beta)\), we have</p> \[\begin{align*} V_0(\phi) &amp;= 2\alpha + \beta \\ V_1^1(\phi) &amp;\leq X \quad \text{ for } V_-(X) \\ \alpha \begin{pmatrix} 1 \\ 3 \\5 \end{pmatrix} + \beta \begin{pmatrix} 1 \\ 1 \\ 1\end{pmatrix} &amp;\leq \begin{pmatrix}1 \\9 \\ 25\end{pmatrix} \end{align*}\] <p>Solving these inequalities, we get \(V_-(X) = 5\), and similarly, \(V_+(X) = 7\). Let us check if \(X\) can be replicated</p> \[\mathbb E^{(c)}(X) = 5 + 8c, 0 &lt; c&lt; \frac{1}{4}\] <p>It is not possible for the expectation to be independent of \(c\). Also note that the range of the above expression is exactly \((5, 7)\).</p> <p>We have seen that \(V_+(X) \geq V_-(X)\) for a contingent claim \(X\).</p> <ul> <li> <p>If \(C_0 &gt; V_+(X)\) then there is a seller’s arbitrage. How? There exists a strategy \(\phi\) such that \(V_T(\phi) \geq X\) and \(V_0(\phi) = V_+(X) &lt; C_0\).</p> </li> <li> <p>Similarly. when \(C_0 &lt; V_-(X)\) there is a buyer’s arbitrage.</p> </li> </ul> <p><strong>Theorem.</strong> A contingent claim \(X\) is replicable <strong>if and only if</strong> \(V_+(X) = V_-(X)\)</p> <p><em>Proof.</em></p> <ul> <li> <p>(\(\implies\)) We saw that previously</p> </li> <li> <p>(\(\Longleftarrow\)) Assume \(V_+(X) = V_-(X)\). Let \(\phi^+\) be a trading strategy such that \(V_T(\phi^+) \geq X\) and \(\phi^-\) is such that \(V_T(\phi^-) \geq X\). However, \(V_0(\phi^+) = V_+(X) = V_-(X) = V_0(\phi^-)\) and consequently \(V_T(\phi^+) - V_T(\phi^-) \geq 0\). Let \(Q \in M\) be any martingale measure -</p> \[\begin{align*} \mathbb E^Q(V_T^*(\phi^+) - V_T^*(\phi^-)) &amp;= V_0^*(\phi^+) - V_0^*(\phi^-) \\ &amp;= (V_0(\phi^+) - V_0(\phi^-))/S_0^0 = 0 \end{align*}\] <p>Therefore, \(V_T(\phi^+) \equiv V_T^(\phi^-) \equiv X\) implying that \(\phi^+\) can be used to replicate \(X\).</p> <p>Suppose \(X\) is not replicable, then there is \(\phi\) such that \(V_T(\phi) \leq X\) and \(V_0(\phi) = V_+(X)\).</p> <p><strong>Claim.</strong> \(P(V_T(\phi) &lt; X) &gt; 0\). If it is equal to \(0\), then \(V_T(\phi) \equiv X\).</p> <p>So, any market price for \(X\) with \(C_) \not \in (V_-(X), V_+(X))\) yields an arbitrage.</p> </li> </ul> <p><strong>Theorem.</strong> \(X\) is replicable <strong>if and only if</strong> \(\mathbb E^Q(X)\) is the same for all \(Q \in M\).</p> <p><em>Proof</em>.</p> <ul> <li> <p>\((\implies)\) \(X = V_T(\phi)\) then</p> \[\mathbb E^Q(X) = \mathbb E^Q(V_T(\phi)) = V_0(\phi) \frac{S_T^0}{S_0^0}\] </li> <li> <p>\((\Longleftarrow)\) Assume for contradition \(X\) is not replicable. As we’ve constructed before, let \(L = \{V_T(\phi): \phi \text{ is a trading strategy}\}\). Since \(X\) is not replicable, \(X \not \in L\). Let \(X = X_0 + Z\) such that \(X_0 \in L\) and \(Z \neq 0, \perp L\). For any \(Q \in M\), we define \(\tilde Q(w_k) = Q(w_k) + c Z_k\). Again, we choose a \(c\) such that \(\tilde Q &gt; 0\) and \(\tilde Q \in M\). Then, since \(\mathbb E^Q(X)\) is the same for all \(Q \in M\), we have</p> \[\begin{align*} \mathbb E^Q(X) &amp;= \mathbb E^{\tilde Q}(X) \\ Q \cdot X &amp;= \tilde Q \cdot X = Q \cdot X + c Z \cdot X \\ &amp;\therefore Z \cdot X = 0 \end{align*}\] <p>implying that \(X \in L\) giving a contradiction.</p> </li> </ul> <h3 id="dual-formulae">Dual Formulae</h3> <p>As a result of the above theorem, we can give alternate formulae to \(V_+(X)\) and \(V_-(X)\) (dual comes from linear programming)</p> \[\begin{align*} V_+(X) &amp;= \sup \{\mathbb E^Q(X): Q \in M\} \\ V_-(X) &amp;= \inf \{\mathbb E^Q(X) : Q \in M\} \end{align*}\] <h1 id="random-walk">Random Walk</h1> <p>In this section, we shall extend our theory beyond finite market models, wherein the price evolution is described using a random walk.</p> <p>Let \(X_n = \xi_1 + \dots + \xi_n\) where \(\mathbb E(\xi_k) = \mu\) and \(\xi\) are iid for \(n = 0, 1, 2, \dots\). Let \(\mathcal F_n = \sigma(\xi_1, \dots, \xi_n)\) and \(\mathcal F_n \perp \!\!\! \perp \xi+{n + k}\) for \(k \geq 1\). Then, consider set of random variables \(M_n = X_n - n \mu\).</p> <p><strong>Claim.</strong> \(M_n\) is a martingale with respect to \(\mathcal F_n\).</p> <p><em>Proof.</em></p> \[\begin{align*} \mathbb E[M_{n + 1} \vert \mathcal F_n] &amp;= \mathbb E[X_{n + 1} \vert \mathcal F_n] - (n + 1)\mu\\ &amp;= \mathbb E[X_n + \xi_{n + 1} \vert \mathcal F_n] - (n + 1)\mu\\ &amp;= X_n + \mu - (n + 1)\mu = M_n \end{align*}\] <p>Assuming that \(var(\xi_k) = \sigma^2\) is finite, consider \(Y_n = M_n^2 - n\sigma^2\).</p> <p><strong>Claim.</strong> \(Y_n\) is a martingale with respect to \(\mathcal F_n\) when \(\mu = 0\)</p> <p><em>Proof.</em></p> \[\begin{align*} \mathbb E[Y_{n + 1} \vert \mathcal F_n]&amp;= \mathbb E[M^2_{n + 1} \vert \mathcal F_n] - (n + 1)\sigma^2\\ &amp;= \mathbb E[(M_n + \xi_{n + 1})^2 \vert \mathcal F_n] - (n + 1)\sigma^2\\ &amp;= M_n^2 + M_n \mu + \sigma^2 - (n + 1)\sigma^2 = Y_n \end{align*}\] <h2 id="optional-stopping">Optional Stopping</h2> <p>Let \(\tau\) be a random variable representing stopping time. Then, we have</p> \[\mathbb E[M_\tau] = \mathbb E(M_0)\] <p>provided \(\tau(w) \leq N\). That is, \(M_{n \wedge \tau}\) is a martingale..</p> <h3 id="single-random-walk">Single Random Walk</h3> <p>We have the following setup</p> \[X_n = x + \xi_1 + \dots + \xi_n\] <p>where \(\xi_k\) are i.i.d. Let \(P(\xi= 1) = p\) and \(P(\xi_k = -1) = q = 1 - p\) where \(0 &lt; p &lt; 1\). We then have</p> \[\mu = 2p - 1, \sigma^2 = 1 - (2p - 1)^2\] <p>Let \(\tau_b := \min(n \geq 0: X_n = b)\) and \(\tau = \min(\tau_a, \tau_b)\).</p> <p><strong>Claim.</strong> Suppose \(p &gt; \frac{1}{2}\) and \(\mu &gt; 0\) then</p> \[\begin{align*} P_x(\tau_b &lt; \infty) = 1 \quad b \geq x \\ P_x(\tau_a &lt; \infty) &lt; 1\quad a &lt; x \end{align*}\] <p><em>Proof.</em> We construct a martingale of the form \(M_n = \alpha^{X_n} \beta^n\) for some \(\alpha &gt; 0\).</p> <p>For \(\alpha &gt; 0\), we let \(\frac{1}{\beta} = \mathbb E(\alpha^{\xi_k}) = \alpha p + \frac{1}{\alpha}(1 - p)\). Then,</p> \[\begin{align*} \mathbb E(M_{n + 1} \vert \mathcal F_n) &amp;= \alpha^{X_n} \beta^{n + 1} \mathbb E(\alpha^{\xi_{n + 1}} \vert \mathcal F_n) \\ &amp;= \alpha^{X_n} \beta^{n + 1} \frac{1}{\beta} = \alpha^{X_n} \beta_n = M_n \end{align*}\] <p>That concludes the proof.</p> <p><strong>Claim.</strong> When \(p \geq \frac{1}{2}\), then \(P_x(\tau_b &lt; \infty) = 1\) where \(\tau_a = \min(n \geq 0: X_n = a)\) (\(=\infty\) if no such \(n\)). Note that we are not dealing with finite timeframe anymore.</p> <p>The graph of \(\beta\) looks like</p> <p><em>Proof.</em> So for \(b \geq X\), we choose \(0 &lt; \alpha &lt; 1\) such that \(\beta &gt; 1\), then</p> \[\begin{align*} \alpha^X &amp;= \mathbb E_X(M_{n \wedge \tau_b}) \\ &amp;= \mathbb E_X(\alpha^{X_{n \wedge \tau_b}} \beta^{n \wedge \tau_b}) \\ &amp;\geq \mathbb E_X (\alpha^b \beta^{n \wedge \tau_b}) \geq \alpha^b \mathbb E_x(\beta^{n \wedge \tau_b}; \tau_b = \infty) \\ &amp;= \alpha^b \beta^n P_X(\tau_b = \infty) \end{align*}\] <p>Letting \(n \to \infty\), we infer \(P_X(\tau_b = \infty) = 0\).</p> <p><strong>Claim.</strong> When \(p &gt; \frac{1}{2}\), then \(P_x(\tau_a &lt; \infty) = \left(\frac{1}{p}\right)^{x - a}\).</p> <p><em>Proof.</em> For \(\frac{q}{p} &lt; \alpha &lt; 1\), \(0 &lt; \beta&lt; 1\)</p> \[\begin{align*} \alpha^X &amp;+ \mathbb E_X(M_{n \wedge \tau_a} ) \\ &amp;= \mathbb E_X(\alpha^{X_n}\beta^n ; n &lt; \tau_a) + \mathbb E_X(\alpha^{X_{\tau_a} \beta^{\tau_a}}; n \geq \tau_a) \\ &amp;\leq \alpha^a \beta^n P_X(n &lt; \tau_a) + \alpha^a\mathbb E_X (\beta^{\tau_a}; \tau_a \leq n ) \\ \end{align*}\] <p>The second term can be simplified using the <strong>Monotone Convergence Theorem</strong> -</p> \[\begin{align*} \mathbb E_X (\beta^{\tau_a}; \tau_a &lt; n) &amp;= \mathbb E_X(\beta^{\tau_a}; \tau_a &lt; \infty) \\ &amp;=\alpha^{x - a} \end{align*}\] <p>Letting \(\alpha \searrow q/p\), \(\beta \nearrow 1\) and</p> \[\left(\frac{q}{p}\right)^{x - a} = \mathbb E_x( 1; \tau_a &lt; \infty) = \mathbb P_X(\tau_a &lt; \infty)\] <p>In summary, we have for \(p &gt; \frac{1}{2}\)</p> \[\begin{align*} P_X(\tau_a &lt; \infty) &amp;= \left(\frac{q}{p}\right)^{x - a} &lt; 1\\ P_X(\tau_b &lt; \infty) &amp;= 1 \end{align*}\] <p>For \(p = \frac{1}{2}\),</p> \[P_X(\tau_b &lt; \infty) = P_X(\tau_a &lt; \infty) = 1\] <p>So irrespective of \(p\), \(P_X(\tau_a \wedge \tau_b &lt; \infty) = 1\).</p> <h4 id="example-3">Example</h4> <p>When \(P_X(\tau_a &lt; \tau_b) = \frac{\rho^b - \rho^x}{\rho^b - \rho^a}\) where \(M_n = \left(\frac{q}{p}\right)^{X_n} = \rho\) (\(p \neq q\))</p> <p>Note that \(M_n = X_n\) when \(p = q\).</p> <p>Let \(\tau = \tau_a \wedge \tau_b\) when \(p \neq q\),</p> \[\rho^X = \mathbb E_X(M_{n \wedge \tau})\] <p>Using the <strong>Dominated Convergence Theorem</strong>,</p> \[\rho^X = \mathbb E_X(M_\tau)\] <p>and we get</p> \[\begin{align*} \rho^X &amp;= \rho^A P_X(\tau_a &lt; \tau_b) + \rho^b P_x(\tau_b &lt; \tau_a) \\ 1 &amp;= P_X(\tau_a &lt; \tau_b) + P_X(\tau_b &lt; \tau_a) \end{align*}\] <h4 id="example-4">Example</h4> <p>Let \(M_n = X^2 - n\), with \(M_0 = X^2\). Then, for \(p = \frac{1}{2}, \sigma^2 = 1, \mu = 1\), \(\tau = \tau_a \wedge \tau_b\), we have</p> \[\begin{align*} X^2 &amp;= \mathbb E_X (X^2_{n \wedge \tau}) - \mathbb E(n \wedge \tau) \\ X^2 + \mathbb E(n \wedge \tau) &amp;= \mathbb E_X (X^2_{n \wedge \tau}) \\ \end{align*}\] <p>Letting \(n \to \infty\) and using Monotone convergence theorem on the left and Dominated convergence theorem on the right, we get</p> \[\begin{align*} X^2 + \mathbb E_X(\tau) &amp;= \mathbb E_X(X_\tau^2) \\ X^2 + \mathbb E_X(\tau) &amp;= a^2\frac{b - x}{b - a} + b^2 \frac{x - a}{b - a}\\ \end{align*}\] <p>resulting in \(\mathbb E_X(\tau_a \wedge \tau_b) = (X - a)(b - X)\).</p> <h1 id="brownian-motion-wiener-process">Brownian Motion (Wiener Process)</h1> <p>Brownian motion is defined as a stochastic process defined on continuous time - \(W = (W_t, t \geq 0)\). It is defined on a probability space \((\Omega, \mathcal F, P)\) and has the following properties -</p> <ul> <li> <p>The initial value is assumed to be \(W_0 = 0\)</p> </li> <li> <p><strong>Independent increments</strong> - Given a set of times \(t_0, \dots, t_n\) such that \(0 = t_0 &lt;t_1 &lt; \cdots &lt; t_n\) then \(W_{t_1} - W_{t_0}, \dots, W_{t_{n}} - W_{t_{n - 1}}\) are independent.</p> </li> <li> <p><strong>Gaussian increments</strong> - For \(0 \leq s \leq t\), \(W_t - W_s \sim \mathcal N(0, t - s)\).</p> </li> <li> <p>For a fixed \(\omega \in \Omega\), the function \(t \to W_t(\omega)\) is continuous.</p> </li> </ul> <p>Equivalently, a Brownian motion is a stochastic process \((w_t: t \geq 0)\) is a Gaussian process with \(\mathbb E(W_t) = 0, cov(W_s, W_t) = s \wedge t\) for all \(s, t\) and \(t \to W_t\) is continuous.</p> <p>This is equivalent to the third property, for \(s &lt; t\),</p> \[\begin{align*} \mathbb E[W_sW_t] &amp;= \mathbb E[W_s(W_s + (W_t - W_s)] \\ &amp;= \mathbb E[W_s^2] + \mathbb E[W_s(W_t - W_s)] \\ \end{align*}\] <p>since \(W_s - W_0\) is a Gaussian distribution and independent increments property,</p> \[\begin{align*} \mathbb E[W_sW_t] &amp;= \mathbb E[W_s^2] + \mathbb E[W_s(W_t - W_s)] \\ &amp;= s^2 + \mathbb E[W_s]\mathbb E[W_t - W_s] = s^2 \end{align*}\] <h3 id="symmetries">Symmetries</h3> <p>Brownian motion is a unique stochastic process that has some symmetry properties. That is, transformations that yield a Brownian motion when applied on a Brownian motion. Let \((W_t)\) be a Brownian motion, then the so are the following</p> <ul> <li> <p><strong>Scaling</strong> - \(\frac{1}{\sqrt{c}} W_{ct}\) for \(c&gt; 0\)</p> </li> <li> <p><strong>Reflection</strong> - \(-W_t\)</p> </li> <li> <p><strong>Time Inversion</strong> - \(tW_{1/t}\) with \(\lim_{t \to 0} tW_{1/t} = 0\)</p> </li> <li> <p><strong>Time Shift</strong> - \(\tilde W_t = W_{t + s} - W_s\), \(t\geq 0\) for a fixed \(s\). This comes in handy to define Markov processes.</p> </li> <li> <p><strong>Time Reversal</strong> - For a \(T &gt; 0\), \(\tilde W_t = \tilde W_{T - t} - W_T\) for \(0 \leq t \leq T\).</p> </li> </ul> <h3 id="more-properties">More Properties</h3> <ul> <li> <p>Define the sigma field \(\mathcal F_s:=\sigma(W_u : 0 \leq u \leq s)\), then \((W_{t + s} - W_s)_{t \geq 0} \perp\!\!\!\perp F_s\) - This is the Markov Property for Brownian Motion.</p> <p>Brownian paths are not smooth</p> \[W_{t + h - W_t} = \mathcal O(\sqrt{h})\] <p>roughly whereas if \(f\) is a \(C'\) function,</p> <p>then \(f(t + h) - f(t) = \mathcal O(h)\). \(\sqrt{h} \gg h\) as \(h \to 0\). A Brownian motion path has a property called <em>fractal</em> and it is nowhere differentiable.</p> <p>Also,</p> \[\sum_{k = 1}^{2^n} [W(k2^{-n} t) - W((k - 1)2^{-n} t]^2 \to t\] <p>as \(n \to \infty\). For a smooth function \(f\), doing the same thing yields \(2^{-n}t \to 0\). This observation forms one of the fundamental building blocks for stochastic calculus.</p> </li> <li> <p>Another peculiar property of Brownian motion has is -</p> <p>$$ \begin{align*} \frac{W_t}{t} &amp;\to 0 <br> \lim_{t \to \infty} \sup W_t &amp;= \infty \</p> </li> </ul> <p>\lim_{t \to \infty} \inf W_t &amp;= -\infty <br> \end{align*} $$</p> <ul> <li> <p>Since Brownian motion is basically the continuous version of random walks, it has some Martingale properties. Specifically, the following processes are martingales</p> \[\begin{align*} W_t \\ W_t^2 - t \\ \exp\left(zW_t - z^2t /2\right) \text{ for } z \in \mathbb C \end{align*}\] <p>The last result comes from the properties of moment generating functions - for a random variable \(X \sim \mathcal N(0, 1)\), we get \(\mathbb E(e^{zX}) = e^{z^2/2}\). Then,</p> \[\begin{align*} \mathbb E(e^{zW_t} \vert \mathcal F_s) &amp;= \mathbb E(e^{zWs} e^{z(W_t - W_s)} \vert \mathcal F_s) \\ &amp;= e^{zW_s} \mathbb E(e^{z(W_t - W_s)}) = e^{zW_s} e^{z^2 (t - s)/2} \end{align*}\] </li> <li> <p>Wiener also studied the integration properties for Brownian motion</p> \[\begin{align*} M_t^f = \int_0^t f(u) dW_u = W_t f(t) - \int_0^t W_u f'(u) du \end{align*}\] <p>for a \(f \in C'\) and non-random. The above expression comes from <em>integration by parts</em> and is called as the <strong>Wiener’s integral</strong>. <u>Also, $$M_t^f$$ is a martingale</u> (This is easy to show).</p> </li> <li> <p><strong>Doob’s inequality</strong> - Let \((M_t)\) be a martingale with right-continuous paths. Then, for each \(t &gt; 0\),</p> \[\mathbb E[\sup_{0 \leq s \leq t} M_s^2] \leq 4\mathbb E[M_t^2]\] </li> <li> <p><strong>Passage times</strong> - Let \(\tau_b = \min(t: W_t = b)\), then</p> \[\mathbb E_x(e^{-\alpha \tau_b}) = \exp(-\sqrt{2\alpha} \vert b - x\vert)\] <p>where \(\mathbb E_x\) means we use \(x + W_t\) (we are changing the initial mean value of \(W_t\)).</p> <p><em>Proof.</em> Fix \(\lambda &gt; 0\) and \(x &lt; b\). Since \(\exp(\lambda W_{t \wedge \tau_b} - \lambda^2(t \wedge \tau_b)/2)\) is a martingale, and is \(\leq e^{\lambda b}\), we get</p> \[\begin{align*} e^{\lambda x} &amp;= \mathbb E_x(e^{\lambda W_{t \wedge \tau_b} - \lambda^2/2 (t \wedge \tau_b)}) \\ &amp;\text{as } t\to \infty \implies \mathbb E_x(e^{\lambda W_{\tau_b} - \lambda^2/2\tau_b}) \quad \because \text{Dominated Convergence Theorem} \\ &amp;= e^{\lambda b} \mathbb E_x(e^{-\lambda^2/2 \tau_b}) \end{align*}\] <p>Taking \(\lambda = \sqrt{2\alpha}\), we get the statement of the theorem. Observe that when \(\alpha \to 0\), the RHS becomes \(1\). Therefore, \(P_x(\tau_b &lt; \infty) = 1\) as \(\alpha \to 0\). That is, Brownian motion will eventually get to any level!</p> </li> <li> <p><strong>Wiener’s integral</strong> - Formally,</p> \[M_t^f := f(t) W_t - \int_0^t w_s f'(s)ds\] <p>It is useful to know the distribution of this process. Thinking of the above integral as Riemann’s sum, we can see that \(M_t^f\) has the distribution \(\mathcal N(0, \sigma^2)\). The variance is calculated as</p> \[\begin{align*} \mathbb E[(M_t^f)^2 ] &amp;= f(t)^2 t + \underbrace{\int_0^t \int_0^t (u \wedge v) f'(u) f'(v) du dv}_{(2)} - \underbrace{2f(t) \int_0^t uf'(u) du}_{(3)} \\ (2) &amp;\implies 2\int_0^t \left(\int_0^u f'(v) dv \right) u f'(u) du \quad\because \text{ by symmetry}\\ &amp;= 2\int_0^t [f(t) - f(u) ]u f'(u) du \\ (2) + (3) &amp;\implies -2\int_0^t uf(u)f'(u) du \\ &amp;= -t f(t)^2 + \int_0^t f(u)^2 du \\ \mathbb E[(M_t^f)^2 ] &amp;= \int_0^t [f(u)]^2 du \end{align*}\] <p>This is a very useful result. In fact, using two different functions -</p> \[M_t^f M_t^g - \int_0^t f(u)g(u) du\] <p>is also a martingale! An easier way to show this would be using <strong>polarization</strong> - manipulate \((M_t^f + M_t^g )^2 - (M_t^f - M_t^g)^2\). Also, \(M_t^f \pm M_t^g = M_t^{f \pm g}\).</p> </li> </ul> <h3 id="donskers-invariance-principle">Donsker’s Invariance Principle</h3> <p>A discrete random walk can be represented as \(S_n = \xi_1 + \cdots + \xi_n\). When \(n\) becomes very large, the magnitude of the random walk scales by \(\frac{1}{\sqrt{n}}\). This is due to the Central Limit Theorem - \(\lim_{n \to \infty} S_n/\sqrt{n} \sim \mathcal N(0, 1)\). It is a useful fact to note while visualizing the random walk to fit the evolution appropriately in space. Also,</p> \[W_n(t) = \begin{cases} \frac{S_k}{\sqrt{n}} &amp; t = \frac{k}{n}, k = 0, 1, \dots, n \\ \text{linearly interpolate otherwise}\end{cases}\] <p>Again, from the CLT, \(\lim_{n \to \infty} W_n(t) \to \mathcal N(0, t)\). The above formulation takes care of appropriately representing large random walks in a bounded space (probabilistically). Alternately, \(W_n\) can be understood as a function from the space \(C([0, 1] \to \mathbb R)\) - continuous functions from \([0, 1]\) to \(\mathbb R\).</p> <p>Now, we are interested in performing operations \(F\) on these random walks -</p> \[\lim_{n \to \infty} \mathbb E[F(W_n)] \to \mathbb E[F(W)]\] <p>for all bounded continious functions \(F: C \to \mathbb R\) (maps each walk \(W_n\) to a real number). Here, \(W\) is a standard Brownian motion. All the above equation is saying is that the discretized formulation \(W_n\) is equivalent to a standard Brownian motion for practical purposes when \(n\) is large.</p> <p>For example, let \(F(x) = \int_{0}^1 x(t) dt\). Then,</p> \[\begin{align*} \vert F(x) - F(y) \vert &amp;\leq \int_0^1 \vert x(t) - y(t) \vert dt \\ &amp;\leq \max_t \vert x(t) - y(t) \vert = \|x - y\|_\infty \end{align*}\] <h3 id="binomial-model-as-a-random-walk">Binomial Model as a Random Walk</h3> <p>We have \(S_t = S_{t - 1} \cdot \xi_t\) where \(P(\xi_t = 1) = p, P(\xi_t = -1) = 1 - p\). How do we model this as a difference equation?</p> \[\begin{align*} S_t - S_{t - 1} &amp;= S_{t - 1} (\xi_t - 1) \\ \equiv \frac{dS_t}{S_t} &amp;= \xi_t - 1 \end{align*}\] <p>The RHS should be equated to \(a \cdot dt + b \cdot dW_t\) for extending it to random walks. The change in the stock price is represented as a composition of a constant value and a random variable. Interpreting this as an integral, we get the expression</p> \[\begin{align*} S_t - S_0 = \int_0^t S_u (a) du + \int_0^t S_u b dW_u \end{align*}\] <p>In this expression, we know how to evaluate \(S_u(a)du\) (integrate with respect to time, sum of values as time evolves), but how do we make sense of \(S_u b dW_u\)? We evaluate the above expression using <strong>Ito’s Stochastic Integral</strong>.</p> <blockquote> <p>Intuition - If you think about stock price, it has an inherent drift and randomness. Using this intuition, we get</p> \[d S_t = \mu S_t dt + \sigma S_t dW_t\] <p>The first integral with respect to \(du\) captures the drift whereas the second term captures the randomness.</p> </blockquote> <h2 id="itos-stochastic-integral">Ito’s Stochastic Integral</h2> <p>How do we calculate the integral \(\int_0^t Y_s dW_s\)? From Wiener’s analysis, we have seen that this expression is a martingale. One approach to evaluate the expression is to it as a combination of Riemman’s sums of step functions -</p> <ol> <li> <p>Let \(Y_t = 1_{(u, v]}(s) \cdot H\) where \(H \in L^2(\mathcal F_u)\)</p> \[M_t = \int_0^t Y_s dW_s = \begin{cases} 0, &amp;t \leq u \\ H(W_t - W_u), &amp;u \leq t \leq v \\ H(W_v - W_u), &amp; t \geq v \end{cases} = H(W_{t \wedge v} - W_{t \lor u})\] <p><strong>Claim.</strong> \(M\) is a <strong>continuous</strong> <strong>martingale</strong> and \(\mathbb E[M_t^2] = \mathbb E[\int_0^t Y_s^2 ds]\)</p> <p><em>Proof.</em> The continuous part is trivial since \(W_{t}\) is continuous. We need to show that \(\mathbb E[M_t \vert \mathcal F_s] \substack{?}{=} M_s\) for \(s&lt; t\)</p> \[\begin{align*} \mathbb E[M_t \vert F_s] &amp;= \mathbb E[H(W_t - W_u) \vert F_s] \\ &amp;= \mathbb E[HW_t \vert F_s] - E[HW_u \vert F_s] \\ &amp;= HW_s - HW_u = M_s \end{align*}\] <p>due to the martingale property of \(W_t\). Finally, for the second moment, we have</p> \[\begin{align*} \mathbb E(M_t^2) &amp;= \mathbb E[H^2(W_{t \wedge v} - W_{t \wedge u})] \\ &amp;= \begin{cases} 0 &amp; t \leq u \\ \mathbb E[H^2(W_t - W_u)^2], &amp; u \leq t \leq v \\ \mathbb E[H^2(W_v - W_u)^2], &amp; t\geq u \end{cases} \\ &amp;= \begin{cases} 0 &amp; t \leq u \\ \mathbb E[H^2](t - u), &amp; u \leq t \leq v \\ \mathbb E[H^2](v - u), &amp; t\geq u \end{cases} \\ &amp;= \mathbb E[H^2(t \wedge u - t \wedge u)] = \mathbb E\left[\int_0^t H^2 1_{(u, v]} (s)ds\right] \end{align*}\] </li> <li> <p>Now, we need to add such \(Y_k\)’s for the required interval (Riemman sum). \(Y_s = \sum_{k = 1}^n 1_{(u_k, v_k]} (s) H_k\) and \(H_k \in L^2 (\mathcal F_{u_k})\) -</p> \[\int_0^t Y_s dW_s := \sum_{k = 1}^n \int_0^t Y_s^{(k)} dW_s\] <p>Since \(Y_s\) is a continuous martingale in \(t\). Also, the <strong>Ito’s Isometry</strong> property states that</p> \[\mathbb E((\int_0^t Y_s dW_s)^2) = \mathbb E(\int_0^t Y_s^2 ds)\] <p>This is easy to show considering non-overlapping intervals. <em>Hint</em>. Consider conditional expectation using Tower law.</p> <p>We have seen this in context of Wiener integrals, but the integrand was considered to be deterministic in that case. Here, we generalize the notion by considering integrands that can be stochastic processes as well.</p> </li> <li> <p><strong>Progressively Measurable</strong> - Consider a finite segment of time \(0 \leq t \leq T\). Then, a stochastic process \(X_t(\omega)\) can be viewed as a function \(\Omega \times [0, T] \to \mathbb R\). Then, the integral \(\int_{0}^t X_s(\omega)ds\) can be viewed as a marginal integral of a joint function. The fact that \(\int_0^t X_s(\omega) ds \in \mathcal F_s\) (the integral is measurable) comes from Fubini’s theorem in Measure theory. Specifically, the process \(X_t(\omega)\) is on the domain \(\Omega \times [0, t]\) and is consequently measurable on \(\mathcal F_t \otimes \mathcal B[0, t]\). Here \(\mathcal B\) refers to <strong>Borel Measurability</strong>. \((X_t)\) is said to be <strong>adapted</strong> to \((\mathcal F_t)\)</p> <p><strong>Claim.</strong> If \(X_t\) is <em>adapted</em> and \(t \to X_t(\omega)\) is left-continuous for all \(\omega \in \Omega\), then \(X\) is progressively measurable.</p> <p>In the previous approach to integrate stochastic processes, we considered \(\mathcal L_s\) class of integrands. That is, we assumed that the integrands can be written as a sequence of step functions. Now, we generalise this notion for any integrands that are progressive measurable</p> \[\mathcal L = \{Y: Y \text{ is progressively measurable and } \mathbb E\left(\int_0^T Y_S^2ds\right) &lt; \infty\}\] <p>A key point to note is that \(\mathcal L_s\) is dense in \(\mathcal L\) (we will not be proving this). That means, given \(Y \in \mathcal L\), there exists a sequence of integrands \((Y^{(n)})_{n \geq 1}\) belonging to \(\mathcal L_s\) such that</p> \[\lim_{n \to \infty} \mathbb E\left[\int_0^T (Y_s - Y_s^{(n)})^2 ds\right] \to 0\] <p>Since each \((Y^{(n)})\) is continuous and a martingale, we will try to show that \(M_t^{(n)} = \int_0^t Y_s^{(n)} dW_s\) is a Cauchy sequence converging to the required integral of \(Y_s\) (note that \((Y^{(n)})\) is Cauchy) -</p> \[\begin{align*} \mathbb E\left[ M_t^{(n)} - M_t^{(m)}\right] &amp;= \mathbb E\left[\int_0^t [Y_s^{(n)} - Y_s^{(m)}]\right] \\ &amp;\leq \mathbb E\left[\int_0^T [Y_s^{(n)} - Y_s^{(m)}]\right] \to 0 \end{align*}\] <p>Therefore, \((M_t^{(n)})_{n \geq 1}\) is Cauchy in \(\mathcal L^2(\mathcal F_t)\). Consequently, there exists \(M_t \in \mathcal L^w(\mathcal F_t)\) such that \(M_t^{(n)} \to M_t\). Then, using Doob’s inequality</p> \[\begin{align*} \mathbb E\left(\sup_{0 \leq t \leq T} \vert M_t^{(n)} - M_t^{(m)}\vert^2 \right) \leq 4 \mathbb E[(M_T^{(n)} - M_T^{(m)})^2] \end{align*}\] <p>we can say that \((M_t)_{0 \leq t \leq T}\) is a path-continuous martingale and \(\mathbb E[M_t^2] = \mathbb E[\int_0^t Y_s^2 ds]\) for all \(t \in [0, T]\) from Ito’s isometry.</p> </li> <li> <p>An alternate way to view the integral is to formulate it as a Riemann integral. If \(Y \in \mathcal L\) is such that \(s \to Y_s(w)\) is left-continuous for all \(\omega \in \Omega\) then</p> \[\int_0^t Y_s dW_s = \lim_n \sum_{k = 0}^{n - 1} Y_{\frac{k}{n}t}\left(W_{\frac{k + 1}{n} t} - W_{\frac{k}{n} t}\right)\] <p>is also a limiting sum of Riemann sums (converges in \(L^2\)). If the above limit converges, then \(Y_s \in \mathcal L^2\).</p> <p><strong>Example</strong> - Consider \(\int_0^t W_s dW_s\) . \(W \in \mathcal L\). How?</p> \[\mathbb E\left[\int_0^T W_s^2 ds \right] = \int_0^T \mathbb E(W_s^2) ds = \int_0^T sds &lt; \infty\] </li> </ol> <p>        from Fubini’s theorem. Also, since \(W\) is         progressive, it is integrable.</p> <h3 id="quadratic-variation">Quadratic Variation</h3> <p>Quadratic variation of a Brownian motion is an important tool in stochastic calculus. Simply put, it is defined as</p> \[\lim_{n \to \infty} Q_t^{(n)} = \lim_{n \to \infty} \sum_{k = 0}^{n - 1} (W_{\frac{k + q}{n} t} - W_{\frac{k}{n}t})^2 = t\] <p>Since the increments are independent are from the distribution \(\mathcal N(0, \frac{t}{n})\), the variance of \(Q_t^{(n)}\) is</p> \[\mathbb E((Q_t^{(n)})^2 ) = 3n \left(\frac{t}{n}\right)^2 + n(n - 1)\left(\frac{t}{n}\right)^2\] <p>implying \(Var(Q_t^{(n)}) = \frac{2}{n} t^2 \to 0\) as \(n \to \infty\).</p> <p>Going back to our example, writing the integral as Riemann sums -</p> \[\begin{align*} W_t^2 &amp;= \sum_{k = 0}^{n - 1} (W^2_{\frac{k + 1}{n} t} - W^2_{\frac{k }{n} t}) \quad \because W_0^2 = 0\\ &amp;= 2 \sum_{k =0}^{n - 1} W_{\frac{k}{n}t} (W_{\frac{k + 1}{n} t} - W_{\frac{k }{n} t}) + Q_t^{(n)}\quad \because \text{telescopic sum} \\ &amp;= 2\int_0^t W_S dW_s + t \end{align*}\] <p>since the above is left-continuous, letting \(n \to \infty\), we get the above expression.</p> <p>We have derived</p> \[W_t^2 - t = \int_0^t 2W_s dW_s\] <p>We can check Ito’s isometry using this.</p> <p>Also, the above expression in reminiscent of the fundamental theorem of calculus. Using this, we now state the following theorem</p> <p><strong>Theorem (Ito’s Formula/Lemma)</strong> For a function \(f \in C^2\) and \(\vert f'(x) \vert \leq c_0 e^{c_1\vert x \vert}\) for constants \(c_0, c_1\),</p> \[f(W_t) = f(W_0) + \int_0^t f'(W_s)dW_s + \frac{1}{2} \int_0^t f''(W_S) ds\] <p>This forms the basis for the fundamental theorem for stochastic calculus.</p> <h2 id="localization">Localization</h2> <p>We define the set</p> \[\mathcal L_{loc} := \{Y: Y \text{ is progressive and } P\left(\int_0^t Y_s^2ds &lt; \infty\right) = 1\}\] <p>This is a weaker condition than \(\mathbb E[\int_0^t Y_S^2 ds] &lt; \infty\), and it allows us to generalize the notion of \(\int_0^t Y_s dWs\) to more integrands.</p> <p>Given a \(Y \in \mathcal L_{loc}\), we define the stop times \(\tau(n) = \inf \{t: \int_0^t Y_s^2 ds &gt; n\} \wedge T\). Then,</p> \[\cap_n \{\tau(n) &lt; T\} \subset \left\{\int_0^T Y_s^2 ds = \infty\right\}\] <p>so \(P(\tau(n) &lt; T) \to 0\) as \(n \to \infty\). Furthermore, defining \(Y_s^{(n)} = \mathbb 1_{(0, \tau(n)]} (s) Y_s\), we get</p> <p>\(\int_0^T (Y_s^{(n)})^2 ds \leq n^2\) implying that \(Y^{(n)} \in \mathcal L\). Also, the martingale \(\int_0^t Y_s^{(n)} dW_s\) is well-defined for each \(n = 1, 2, \dots\).</p> <p>They are also consistent - For \(m &lt; n\), \(\tau(m) &lt; \tau(n)\) and</p> \[\int_0^t Y_s^{(m)} dW_s = \int_0^t Y_s^{(n)} dW_s\] <p>if \(t \in [0, \tau(m)]\).</p> <p>Since \(P(\tau(n) &lt; T) \to 0\) as \(n \to \infty\), and on \(\cup_n \{\tau(n) = T\}\), we have</p> \[I_t = \lim_n \int_0^t Y_s^{(n)}dW_s, 0 \leq t \leq T\] <p>and \(I_{t \wedge \tau(n)} = \int_0^t Y_s^{(n)} dW_s\) is a martingale.</p> <p>This process \(I\), which we use as our definition of \(\int_0^t Y_s dW_s\) is an instance of a <strong>local martingale</strong>.</p> <p>A <strong>local martingale</strong> is an adapted process \(M = (M_t)\) for which there is an increasing sequence \((\sigma(n))\) of stopping times such that \(P(\sigma(n) &lt; T) \to 0\) as \(n \to \infty\) and \(M_{t \wedge \sigma(n)}\) is a martingale.</p> <p>When the martingales and local martingales have continuous paths, \((\sigma(n))\) can be taken to be \(\sigma(n) = \inf(t: \vert M_t \vert n) \wedge T\). In particular it can always be arranged that \(\vert M_{t \wedge \sigma(n)} \vert \leq K_n\) for all \(t\).</p> <h2 id="itos-process">Ito’s Process</h2> <p>An Ito’s process is a continuous adapted process \(X = (X_t)\) of the form</p> \[X_t = X_0 + \int_0^t Y_s dW_s + \int_0^t b_s ds, 0 \leq t \leq T\] <p>where \(Y \in \mathcal L_{loc}\) and \(b = (b_s)\) is progressive with \(\int_0^T \vert b_s\vert ds &lt; \infty\).</p> <p>Revisiting the notion of quadratic variation, the <strong>quadratic variation of</strong> \(X\) is formally defined as \(\langle X\rangle\) -</p> \[\langle X\rangle_t = \int_0^t Y_s^2 ds, 0 \leq t \leq T\] <p>For a non-random continuous function \(g\), the process \(G_t = \int_0^t g(s)ds\) has \(0\) quadratic variation.</p> <p><strong>Theorem (Ito Formula II)</strong> Let \(f: \mathbb R \times [0, T]\) be of class \(C^{2, 1}\). If \(X\) is an Ito’s process as defined above, then so is \(f(X_t, t)\) with</p> \[f(X_t,t) = F(X_0, 0) + \int_0^t f_x(X_s, s)dX_s + \int_0^t f_t(X_s, s)ds + \frac{1}{2} \int_0^t f_{xx} (X_s, s_ d)\langle X\rangle_s\] <p>where \(dX_s = Y_s dW_s + B_s ds\) and \(d\langle X\rangle_s = Y^2_s ds\).</p> <h3 id="example-5">Example</h3> <p>Consider the case of Stochastic exponential,</p> <p>For a \(Y \in \mathcal L_{loc}\) we define \(M_t = \int_0^t Y_s dW_s\) (local martingale). Define</p> \[Z_t = \exp(M_t - \frac{1}{2} \langle M\rangle_t), 0\leq t\leq T\] <p>By Ito’s formula for \(f(x) = e^x\) and Ito’s process \(X_t = M_t - \frac{1}{2} \langle M\rangle_t\), we have</p> \[Z_t = 1 + \int_0^t z_s dM_s \equiv dZ_t = Z_t dM_t \;\&amp;\; Z_0 = 1\] <p>Again, \(Z\) is a local martingale.</p> <ul> <li> <p>Since \((Z_t)\) is a strictly positive local martingale, it’s a supermartingale (<strong>Fatou’s Lemma</strong>)</p> </li> <li> <p>If \(\vert Y_s(w)\vert \leq K\) for all \(s, w\), then \(Z\cdot Y \in \mathcal L\) and \(Z\) is a true martingale.</p> </li> </ul> <h1 id="black-scholes-model">Black-Scholes Model</h1> <p>As usual, consider two assets to be traded given by</p> <ul> <li>Bond</li> </ul> \[\begin{align*} B_t &amp;= e^{rt}, r &gt; 0 \\ dB_t &amp;= rB_t dt, B_0 = 1 \end{align*}\] <ul> <li>Stock</li> </ul> \[\begin{align*} S_t &amp;= S_0 \exp(\sigma W_t + (\mu - \sigma^2/2)t)\\ dS_t &amp;= S_t (\sigma dW_t + \mu dt) \quad \text{From Ito's formula} \end{align*}\] <p>Note that \(\sigma W_t + \mu t\) is a Brownian motion with <strong>volatility</strong> \(\sigma &gt; 0\) and <strong>drift</strong> \(\mu \in \mathbb R\)</p> <p>A <strong>trading strategy</strong> is a pair \(\phi = (\alpha, \beta)\) of progressive processes \((\alpha_t)\), \((\beta_t)\) such that \(\int_0^T \alpha_s^2 ds &lt; \infty\) and \(\int_0^T \vert \beta_s\vert ds &lt; \infty\) (they are <em>progressively measurable</em>). \(\alpha\) represents the holdings in stock and \(\beta\) represents the holdings in bond. At any time \(t\),</p> \[V_t(\phi) = \alpha_t S_t + \beta_t B_t\] <p>For a trading strategy to be <strong>self-financing</strong>,</p> \[V_t(\phi) - V_0(\phi) = \int_0^t \alpha_u dS_u + \int_0^t \beta_u dB_u, 0 \leq t\leq T\] <p>where \(dS_u = S_u(\sigma dW_u + \mu du)\) and \(dB_u = re^{ru}du\). In particular, \(V_t(\phi)\) is an Ito process.</p> <p>The importance of \(\alpha\) being progressively measurable comes in handy here, since we want \(\sigma \alpha S_u \in \mathcal L_{loc}\) . That is because \(S_u\) is positive, \(\int_0^T \alpha_u^2 S_u^2 du &lt; \infty \iff \int_0^T \alpha_u^2 du &lt; \infty\)</p> <p>Once again, we define the discounted processes</p> \[\begin{align*} V_t^*(\phi) &amp;= V_t(\phi) /B_t = V_t e^{-rt} \\ S_t^*(\phi) &amp;= S_t(\phi) /B_t = S_t e^{-rt} \\ \end{align*}\] <p>and consequently,</p> \[V_t^*(\phi) - V_0(\phi) = \int_0^t \alpha_u dS^*_u\] <h4 id="product-rule-for-itos-calculus">Product Rule for Ito’s Calculus</h4> <p>Suppose we have two Ito’s processes \(X_t = X_0 + \int_0^t H_s dWs + \int_0^T bs_ds\) + \(Y_t = Y_0 + \int_0^t K_s dWs + \int_0^T cs_ds\), then their product is also an Ito’s process</p> \[d(X_tY_t) = X_t dY_t + Y_t dX_t + d\langle X,Y\rangle_t\] <p>where \(\langle X, Y \rangle_t = \int_0^t H_sK_s ds\) is the quadratic covariation.</p> <h3 id="arbitrage-3">Arbitrage</h3> <p>An arbitrage is a self-financing trading strategy \(\phi\) is such that \(V_0(\phi) = 0\) and \(V_T(\phi) \geq 0\) with \(P(V_T(\phi) &gt; 0)&gt; 0\).</p> <p>The binomial model is viable and complete. However, it is easy to create arbitrage opportunities in Black-Scholes model -</p> \[\begin{align*} I_t &amp;= \int_0^t \frac{1}{\sqrt{T - s}} dW_u, 0\leq t &lt; T \\ \langle I \rangle_t &amp;= \log\frac{T}{T - t} \nearrow \infty \text{ as } t \nearrow T \end{align*}\] <p>The quadratic variation represents the energy of the martingale in a way. We further define \(\tau_q = \inf (t: I_t = a) \wedge T\) for some \(a &gt; 0\) (\(P(\tau_a &lt; T) = 1\)). Now, the trading strategy is given by</p> \[\begin{align*} \alpha_t &amp;= \mathbb 1_{t \leq T} \frac{1}{\sqrt{T - t}} \frac{1}{S_t} \\ \beta_t &amp;= I_{t \wedge \tau_a} - \alpha_t s_t \end{align*}\] <p>Let \(r = 0, B_t = 1\) for simplicity. Then,</p> \[\begin{align*} V_t(\phi) = I_{t \wedge \tau_a} \end{align*}\] <p>implying \(V_0(\phi) = , V_T(\phi) = I_{\tau_a} = a &gt; 0\).</p> <h3 id="equivalent-martingale-measure">Equivalent Martingale Measure</h3> <p>When \(\mu = 0\), we have \(S_t = S_0 e^{\sigma W_t - \sigma^2t/2}\) is a martingale. Then, \(P\) itself is an EMM. When \(\mu \neq 0\), we need to find a \(Q\) on \((\Omega, \mathcal F_T)\) that is equivalent to \(P\). How do we check equivalence here? \(Q(A) &gt; 0 \iff P(A)&gt; 0\) for all \(A \in \mathcal F_t\).</p> <h4 id="girsanovs-theorem">Girsanov’s Theorem</h4> <p>Let \(H \in \mathcal L_{loc}\) and \(M_t = \int_0^t H_S dW_s\) and \(\langle M \rangle_t = \int_0^t H_s^2 ds\), then</p> \[\Lambda_t := \exp(M_t - \frac{1}{2} \langle M\rangle_t) = 1 + \int_0^t \Lambda_s dM_s\] <p>is <strong>continuous in</strong> \(t\) <strong>, positive, local martingale and a supermartingale</strong>. We have \(\mathbb E(\Lambda_t) \leq 1\), \(t \in [0, T]\). The process is a martingale when \(\mathbb E(\Lambda_t) = 1\).</p> <p>Now, the theorem states that suppose \(\mathbb E(\Lambda_t) = 1\) for all \(t \in [0, T]\) (\(\iff \mathbb E(\Lambda_T) = 1 \iff \Lambda_t\) is a martingale ). We define</p> \[Q(A) := \mathbb E^P (\mathbb 1_A \Lambda_T), A \in \mathcal F_T\] <p>then \(Q \sim P\) and</p> \[N_t := \int_0^t Y_s dW_s\] <p>for \(Y \in \mathcal L_{loc}\) is a local martingale with respect to \(P\) and</p> \[\tilde N_t = N_t - \int_0^t Y_s H_s ds\] <p>is a local martingale with respect to \(Q\).</p> <p>Finally, \(\langle N \rangle_t = \langle \tilde N\rangle_t\). In particular, consider</p> \[\tilde W_t = W_t - \int_0^t H_s ds\] <p>then \(\tilde W_s\) is a local martingale with respect to \(Q\) and \(\langle \tilde W \rangle = t\). It can be shown that any process with quadratic variation equating to \(t\) is a Brownian motion!</p> <p>Using this theorem, we try and define a martingale for \(S_t^*\)</p> \[S_t^* = S_0 \exp (\sigma W_t + (\mu - r - \sigma^2/2)t)\] <p>Let \(H_t = \theta = \frac{\mu - r}{\sigma}\), then \(S^*\) is a martingale with respect to \(Q\).</p> <p>By Ito’s formula,</p> \[\frac{dS^*_t}{S_t^*} = \sigma\left\{dW_t + \underbrace{\frac{\mu - r}{\sigma}}_{\theta} dt \right\}\] <p>Using Girsanov’s theorem with $H_s = - \theta$, $P^* = \Lambda_t P$ is an EMM.</p> \[S_t^* = S_0 + \int_0^t S_u^* d \tilde W_u\] <p>so $S_t^*$ is a local martingale. Furthermore,</p> \[\begin{align*} \mathbb E^*((S_t^*)^2) &amp;= \mathbb E^*(\exp(2\sigma \tilde W_t - \sigma^2 t))S_0^2. \\ &amp;= e^{4\sigma^2 t/2 - \sigma^2 t}S_0^2 = S_0^2 e^{\sigma^2t} \end{align*}\] <p>Consequently,</p> \[\mathbb E^*[\int_0^T (S_t^*)^2 dt] = S_0^2 \int_0^T e^{\sigma^2 t}dt = S_0^2 \frac{e^{\sigma^2T} - 1} {\sigma^2} &lt; \infty\] <p>implying that $S_t^* \in \mathcal L_{loc}(P^<em>)$ and $(S_t^</em>)$ is a $P^*$-martingale.</p> <p><strong>Corollary</strong> If $\phi$ is a self-financing trading strategy, then $V_t^<em>(\phi)$ is a $p^</em>$-local martingale.</p> <p><em>Proof.</em></p> \[\begin{align*} V_t^*(\phi) &amp;= V_0(\phi) + \int_0^t \alpha_u dS_u^* \\ &amp;= V_0(\phi) + \int_0^t (\alpha_u S_u^*) d\tilde W_u \end{align*}\] <p>and $\alpha_uS_u^* \in \mathcal L_{loc}(P^*)$ by path continuity.</p> <p><strong>Definition.</strong> A self-financing trading strategy is <strong>admissible</strong> provided $V_t^<em>(\phi)$ is a $P^</em>$-martingale (not just a local martingale).</p> <p>Also, if $\mathbb E^<em>[\int_0^T \alpha_s^2 (S_s^</em>)^2ds &lt; \infty$, then $\phi$ is admissible.</p> <h2 id="martingale-representation-theorem">Martingale Representation Theorem</h2> <p>If $(M_t)$ is a $P^*$-martingale (such that $t \to M_t$ is right continuous) then there exists a unique $\eta = (\eta_t)<em>{0 \leq t \leq T} \in \mathcal L</em>{loc}$ such that</p> \[M_t = M_0 + \int_0^t \eta_s d\tilde W_s, 0 \leq t \leq T\] <p><strong>Corollary.</strong> Given $X \in L^1(\mathcal F_T, P^<em>)$, there is a unique admissible $\phi$ such that $\mathbb E^</em>(X^* \vert \mathcal F_t) = V_t^<em>(\phi)$ for $0 \leq t\leq T$ ($X^</em> = e^{-rT} X$).</p> <p><em>Proof.</em> Define a right continuous $P^*$-martingale $M$ by</p> \[M_t := \mathbb E^*(X^* \vert \mathcal F_t)\] <p>By the martingale representation theorem, there exists a unique $\eta$ such that</p> \[M_t = M_0 + \int_0^t \eta_u d \tilde W_u = M_0 + \int_0^t \alpha_u dS_u^*\] <p>where $\alpha_u := \eta_u/S_u^* \in \mathcal L_{loc}$. Define $\beta_t := M_t - \alpha_t S_t^*$ which is continuous. Then, $\phi := (\alpha_t, \beta_t)$ is a self-financing trading strategy and</p> \[V_t^*(\phi) = \alpha_t S_t^* + \beta_t = M_t\] <p>is a martingale and hence, admissible. Also,</p> \[V_0(\phi) = M_0 = \mathbb E^*[X^* \vert \mathcal F_0] = \mathbb E^*[X^*]\] <p>Therefore, <strong>each</strong> $X \in L^1(P^*)$ <strong>is replicable</strong>!</p> <h2 id="pricing-a-european-contingent-claim">Pricing a European Contingent Claim</h2> <p><strong>Theorem.</strong> The unique no arbitrage price of the European claim $X \in L^1 (P^<em>)$ is $V_t(\phi) = e^{-r(T - t)} \mathbb E^</em>(X \vert \mathcal F_t)$.</p> <p>The European call option is given by $X = (S_T - K)^*$</p> <p>Let us compute $\mathbb E^<em>(X^</em> \vert \mathcal F_t)$ - Firstly, we have</p> \[S_T^* = S_t^* \exp(\sigma(\tilde W_T - \tilde W_t) - \frac{\sigma^2}{2} (T - t))\] <p>and $\tilde W_t - \tilde W_t \sim \mathcal N(0, T - t) \perp!!!\perp_{p^*} \mathcal F_t $. Renaming $\tilde W_T - \tilde W_t$ as $\sqrt{T - t} Z$ where $Z \sim \mathcal N(0, 1)$ -</p> \[\begin{align*} \mathbb E^*((S^*_T - K^*)^+ \vert \mathcal F_t) &amp;= E[(S_t^*\exp(\sigma Z\sqrt{T - t} - \frac{\sigma^2}{2}(T - t)) - K^*)^+] \\ \mathbb E^*[g(S_T^*) \vert \mathcal F_t]&amp;= \mathbb E[g(xe^{\alpha z - \alpha^2/2}) \vert \mathcal F_t] \end{align*}\] <p>where $x = S_t^<em>$ and $\alpha = \sigma \sqrt{T - t}$. Let us work with this expression. Letting $\phi(z) = \frac{1}{\sqrt{2\pi}}e^{-z^2/2}$ we get $\mathbb E^</em>[g(S^<em>_T) \vert \mathcal F_t] = f(S_t^</em>, t)$ where</p> \[f(x, t) = \int_{-\infty}^{\infty} g(xe^{\alpha z - \alpha^2/2})\phi(z) dz\] <p>Now,</p> \[g(xe^{\alpha z - \alpha^2/2}) = \begin{cases} xe^{\alpha z - \alpha^2/2} - K^* &amp; z &gt; l \\ 0 &amp; z \leq l \end{cases}\] <p>where $l = \frac{L}{\alpha} + \frac{\alpha}{2}$. and $L = \log(K^*/x)$. Then, we get $f(x, t) = (1) + (2) $ where</p> \[\begin{align*} (1) &amp;= x\int_l^\infty e^{\alpha z - \alpha^2 /2} \phi(z) dz \\ &amp;= x \int_{\tilde l} ^\infty \frac{1}{\sqrt{2\pi}} e^{-y^2/2}dy = x \Phi(\frac{\alpha}{2} - \frac{L}{\alpha}) \\ (2) &amp;= -K^*\int_l^\infty \phi(z) dz \\ &amp;= -K^* \Phi(-l) \end{align*}\] <p>Finally, we get</p> \[C^*(t) = f(x, t) = x \Phi\left(\frac{\log{(x/K^*)}}{\sigma \sqrt{T - t}} + \frac{\sigma \sqrt{T - t}}{2}\right) - K^* \Phi\left(\frac{\log(x/K^*)}{\sigma \sqrt{T - t}} - \frac{\sigma \sqrt{T - t}}{2}\right)\] <p>Let us now try to replicate the option using a trading strategy -</p> <p>We have seen that</p> \[V_t(\phi) = e^{rt} f(S_t^*, t)\] <p>We have</p> \[f(x, t) = x \Phi\left(\frac{\log{(\alpha/K^*)}}{\sigma \sqrt{T - t}} + \frac{\sigma \sqrt{T - t}}{2}\right) - K^* \Phi\left(\frac{\log(\alpha/K^*)}{\sigma \sqrt{T - t}} - \frac{\sigma \sqrt{T - t}}{2}\right)\] <p>where \(X = (S_t - K)^+, K^* = Ke^{-rT}, \Phi =\) standard normal CDF. Here, \(f\) is smooth in the sense that it is twice differentiable in \(S_t^*\) and differentiable in \(t\). Using Ito’s formula, since \(V_t^*(\phi)\) is a martingale,</p> \[V_t^*(\phi) = V_0^*(\phi) + \int_0^t \underbrace{\frac{\partial f}{\partial x} (S_u^*, u)}_{\alpha_u} dS_u^* + \cdots\] <p>The remaining integral terms cancel out to \(0\)</p> <blockquote> <p>Why?</p> </blockquote> <p>Consequently,</p> \[\begin{align*} \alpha_t &amp;= \frac{\partial f}{\partial x} (S_t^*, t) = \Phi\left(\frac{\log(S_t^*/K^*)}{\sigma \sqrt{T - t}} + \frac{\sigma \sqrt{T - t}}{2}\right) \\ \beta_t &amp;= V_t^*(\phi) - \alpha_t S_t^* \end{align*}\] <p>We can check that when \(S_T &gt; K, \alpha_t \to 1\), and \(S_T &lt; K, \alpha_t \to 0\).</p> <p>Let \(X^* = g(S_T^*)\), then, \(V_T^*(\phi) = f(S_t^*, t) = \mathbb E^*(g(S_t^*) \vert \mathcal F_t)\) and \(\lim_{t \uparrow T} f(x, t) = g(x)\)</p> <p>Also,</p> \[\frac{\partial f}{\partial t} + \frac{1}{2} \sigma^2 x^2 \frac{\partial^ f}{\partial x^2} \equiv 0\] <p>for \((x, t) \in (0, \infty) \times [0, T)\). This PDE has a unique solutions when \(g\) has certain properties.</p> <h2 id="black-scholes-formula">Black-Scholes Formula</h2> <p>Consider the market with the assets \(S_t = (S_t^0, S_t^1, \dots, S_t^d)\) where \(S_t^0 = B_t = e^{\int_0^t r_s ds}\) and \((r_s)_{0 \leq s \leq T}\) is a progressive process (\(r_s \geq 0, \int_0^t r_s ds &lt; \infty\)). This formulation maintains \(\frac{d S_t^0}{S_t^0} = r_t dt\).</p> <ul> <li> <p>The stocks have drifts \(\mu_t^1 , \dots, \mu_t^d\) which are progressive processes and \(\int_0^T \vert \mu_t^i \vert dt &lt; \infty\) for all \(i\).</p> </li> <li> <p>The volatilities are represented as a matrix \(\sigma^T = \begin{bmatrix} \sigma^1 &amp;\sigma^2 &amp; \dots &amp; \sigma^d \end{bmatrix}\) (\(d \times n\)) where \(\sigma_t^{ij}\) is progressive and \(\int_0^T \|\sigma_t^i\|^2 dt &lt; \infty\).</p> </li> <li> <p>\(W = (W^1, \dots, W^n)\) are independent 1-dimensional standard Brownian Motions.</p> </li> </ul> <p>Using these elements, the price process is defined as</p> \[S_t^i = S_0^i \exp\left(\int_0^t \sigma_u^i \cdot dW_u - \frac{1}{2} \int_0^t \vert \sigma_u^i \vert ^2 du + \int_0^t \mu_u^i du\right)\] <p>Then, the using the basic definitions, a trading strategy is \(\phi_t = (\phi_t^0, \dots, \phi_t^d)\) and</p> \[\begin{align*} V_t(\phi) &amp;= \phi_t \cdot S_t\\ &amp;= V_0(\phi) + \int_0^t \phi_u \cdot dS_u \quad \because \text{self financing} \\ \equiv V_t^*(\phi) - V_0(\phi) &amp;= \sum_{i = 1}^d \int_0^t \phi_u^i dS_u^{i, *} \end{align*}\] <p>Also, given any strategy \(\tilde \phi = (\tilde \phi_t^1, \dots, \tilde \phi_t^d)\) which is progressive and integrable and \(c \in \mathbb R\), representing the initial holdings, there exists \(\phi_t^0\) such that</p> <p>\(\phi_t = (\phi_t^0, \tilde \phi_t^1, \dots, \tilde \phi_t^d)\) is a self-financing trading strategy \(V_0(\phi) = c\).</p> <hr> <p>A tame trading strategy \(\phi\) there exists \(c &gt; 0\) , \(V_t^*(\phi) \geq -c\), \(\forall t \in [0, T]\).</p> <p>Consequently, \(V_t^*(\phi) + c \implies V_t^*(\phi)\) is a \(Q\)-supermartingale.</p> <p><strong>Proposition</strong> - If there is an ELMM \(Q\) then no tame trading strategy can be an arbitrage. <em>Proof.</em> Suppose you have a tame trading strategy with \(V_T^*(\phi) \geq 0\) and \(V_0^*(\phi) = 0\). Due to supermartingale property,</p> \[\begin{align*} E^Q(V_T^*(\phi)) &amp;\leq \mathbb E^Q(V_0^*(\phi)) \\ &amp;= V_0(\phi) = 0 \end{align*}\] <p><strong>Theorem. (FFTAP)</strong></p> <ul> <li>No free lunch with vanishing risk\(\iff\) there exists an ELMM</li> </ul> <p>ELMM via Girsanov’s theorem - For any \(Q \sim P\) there exists a \(\Lambda_t\), such that \(\left. \frac{dP}{DQ} \right\vert_{\mathcal F_t} = \Lambda_t\). This is equivalent to saying</p> \[Q(A) = \mathbb E^P(\mathbb 1_A \Lambda_t)\] <p>For all \(A \in \mathcal F_t\). Here, \(\Lambda_t\) is a \(P\)-martingale. We want the form \(\Lambda_t = \exp(M_t - \frac{1}{2}\langle M\rangle_t))\) for the Girsanov’s theorem. Consider the following - Using Ito’s theorem</p> \[d(\log(\Lambda_t)) = \frac{1}{\Lambda_t}{d \Lambda_t} + \frac{1}{2} \frac{1}{\Lambda_t^2} d\langle\Lambda\rangle_t\] <p>Resembling that \(dM_t = \frac{1}{\Lambda_t} d\Lambda_t\).</p> <p>Using Martingale representation theorem, \(M_t = - \int_0^t \theta_s \cdot dW_s\). With \(Q = \exp(M_T - \frac{1}{2} \langle M\rangle_T)P\), Girsanov’s theorem gives us</p> \[\tilde W_t = W_t + \int_0^t \theta_s ds\] <p>is a \(Q\)-Brownian motion. Going back to our Black-Scholes model,</p> \[S_t^{i,*} = S_0^i \exp(\int_0^t \sigma_s^i\cdot dW_s - \frac{1}{2} \int_0^t \vert \sigma_s^i\vert^2 ds + \int_0^t (\mu_s^i - r_s) ds)\] <p>We want to choose \(\theta\) such that \(\tilde W_s\) captures the drift term. That is, let \(-\sigma_s^i \cdot \theta_s + \mu_s^i - r_s = 0\), then</p> \[S^{i,*}_t = S_0^I \exp(\int_0^t \sigma_s^i \cdot d \tilde W_s - \frac{1}{2} \int_0^t \vert \sigma_s^i \vert^2 ds)\] <p>Simply put, we are trying to find a \(Q\)-martingale given \(\sigma_s^i, \mu_s^i, r_s\) for all $\omega, s\(in terms of\)\theta_s\(. In other words, we are checking if\)\mu_s - r_s {\bf 1}\(is in the column span of\)\sigma_s\(. We are working our way backwards to find an ELMM\)Q\(using the Black-Scholes model. Using\)\theta_s\(, we get\)(\Lambda)_t\(. But when is this a\)P$$-martingale? A super-martingale with same initial and final expectations is a martingale.</p> <p><strong>Novikov’s condition</strong> - If \(\mathbb E^p[e^{\frac{1}{2} \langle M\rangle_T}] &lt; \infty\), then \(\Lambda_t = \exp(M_t - \frac{1}{2} \langle M\rangle_t)\) for all \(0 \leq t \leq T\) is a \(P\)-martingale.</p> <p><strong>Theorem.</strong> If \(n = d\), and \(\sigma_s\) is invertible for all \(\omega, s\) and \(\mathbb E^p [e^{\frac{1}{2} \in_0^t \vert \theta_s\vert^2 ds}] &lt; \infty\), then \(Q\) is an ELMM.</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/Lattices-in-Cryptography/">Lattices in Cryptography and Quantum Computers</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/Modulo-Compressed-Sensing/">Modulo Compressed Sensing</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/Object-Detection/">Object Detection</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/GANs-for-Compressed-Sensing/">Generative Adversarial Networks for Compressed Sensing</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/Low-Rank-Tensor-Recovery/">Low Rank Tensor Recovery for Joint Probability Distribution</a> </li> </div> <script>document.querySelectorAll("#table-of-contents a").forEach(function(e){e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substring(1);document.querySelectorAll(".content-section").forEach(function(e){e.classList.add("hidden")});var n=document.getElementById(t);n&&n.classList.remove("hidden")})});</script> </div> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Sudhansh Peddabomma. Last updated: May 28, 2024. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?9b43d6e67ddc7c0855b1478ee4c48c2d" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-0K9MLG0V24"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-0K9MLG0V24");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>